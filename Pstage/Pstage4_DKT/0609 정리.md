# Customized KFold 에러 디버깅

## 1)

Input

```python
class LastSolveKFold(KFold):
    def __init__(self,
                user_id,
                n_splits=10,
                shuffle=True,
                random_state=42
                ):
        self.user_id = user_id
        self.n_splits = n_splits
        self.shuffle = shuffle
        self.random_state = random_state

    def split(self, X, y=None, groups=None):
        X, y, groups = [np.array(iterable) for iterable in (X, y, groups)]
        n_samples = len(X)
        #########################################
        last_user_index = np.where(np.roll(self.user_id, shift=-1) != self.user_id)[0]
        total_val_indices = []
        total_indices = np.arange(n_samples)
        for _, test_idx in super().split(last_user_index):
            test_idx = last_user_index[test_idx]
            total_val_indices.extend(test_idx)
            train_idx = [tr_id for tr_id in total_indices if not tr_id in test_idx]
            print(f'train_idx : {len(train_idx)}')
            print(f'val_idx : {len(test_idx)}')
            print(f'val_idx : {test_idx}')
            print(f'shape of X : {X.shape}')
            yield np.array(train_idx), np.array(test_idx)
        print(f"valid Set이 된 모든 row들의 개수 : {len(total_val_indices)}")
        print(f"valid Set이 된 모든 row들 unique 개수 : {len(set(total_val_indices))}")

    def get_n_splits(self, X, y=None, groups=None):
        return self.n_splits

user_id = np.array(tr_val['userID'])
last_fold = LastSolveKFold(user_id=user_id, n_splits=10, shuffle=True, random_state=42) 
```

Output

```bash
train_idx : 2272615
val_idx : 745
val_idx : [   744   1677   1953   2988   3658   4491   5412   6224   6760   7627
   7997   8602   9541  10857  11519  12737  14015  15274  16057  17001
  17719  18858  19464  21019  21988  23140  23526  24994  26036  26889
  27816  28506  29439  30387  31554  32245  32781  33375  33742  34670
  35580  36630  37152  37881  38797  39880  40786  41416  42304  43510
  44830  46492  46928  47620  49325  50042  50879  51108  51918  52589
  53699  54931  55123  56073  57342  58186  58687  59845  60515  60990
  61850  62621  63005  63374  63986  65557  65966  66822  68047  69116
  70332  71331  72482  73304  74570  75493  76148  77378  78920  79632
  79866  80256  81229  82797  84088  85113  86266  87048  87854  88681
  89627  89861  91016  91728  92358  93006  94121  94756  95510  96862
  97993  98480  99450 101046 101735 102053 102647 104145 105352 106583
 107116 107334 108368 108706 109144 109865 110399 111312 111994 112858
 113299 114330 115370 116131 116824 117690 118834 119232 119585 120183
 120807 121592 121979 122486 123826 125011 125576 126613 127279 128104
 128992 129603 130893 131357 132178 132686 133521 134336 135816 136753
 137544 138784 139639 140227 141140 142222 142669 143401 144464 145961
 146530 147482 148114 148514 150039 150501 151692 152240 152790 153006
 153848 154592 155095 155647 156611 157111 158748 159416 159861 160835
 161420 161833 162933 163199 163640 164179 164785 165837 166302 167182
 168065 168798 169817 171134 172074 172729 173602 174521 175350 175835
 176754 177475 177939 178540 179325 180651 181283 182328 183210 183683
 184624 185734 186286 186973 188112 188650 188865 189226 189560 190459
 191259 192065 193134 193812 194866 195721 195983 196499 197187 197922
 198310 198937 199645 200855 201343 202155 202881 203923 204719 205423
 205995 206762 208179 208628 209613 211330 211964 212681 213201 214118
 215452 216228 216992 217859 218545 219319 220327 221184 222187 222904
 223114 224482 225014 225452 226177 226796 228109 228975 229666 230825
 231049 231293 232046 232262 232531 233093 234033 234905 236432 237204
 238310 239157 239988 241009 241786 242489 243358 243879 245018 245618
 246088 246582 247231 247726 248740 249385 250398 251326 252268 252808
 253967 255040 255553 256389 257365 257944 258873 259290 259883 260911
 261357 262483 263805 264543 265620 266420 266862 267584 267997 268501
 269696 270247 271412 271801 272963 273322 274069 275055 275809 276314
 277186 278045 278415 279362 279799 280390 280986 282100 282660 283931
 285032 285796 286698 287398 288571 289140 290272 290730 291325 292277
 293239 293738 294234 295249 296211 296724 297409 298018 298833 299084
 300289 301461 303048 304451 305448 306685 307378 308273 308802 309139
 310228 310939 311597 312220 313059 313499 313968 315113 315767 316235
 317466 318325 319098 320067 321841 322251 322534 323338 324736 325347
 325931 326510 327494 328900 330385 331114 331782 332439 333916 335046
 336206 337294 338306 338917 339698 340224 340575 341888 343011 343807
 345059 345770 346578 347450 348352 348741 349658 350212 350806 352391
 352969 353947 354177 355515 356287 356855 358159 358746 359428 360049
 360735 361281 362036 362808 363460 363801 364123 365047 365814 366633
 367939 368806 369491 370079 371038 372530 373808 374844 375628 376443
 377039 377588 378384 378886 379580 380072 381645 382320 382587 383345
 383978 384823 385211 386184 386844 387565 388117 388967 389731 390401
 390793 392640 393138 393766 394563 395172 396219 397247 398542 399036
 399973 400160 400733 401099 401892 402714 403463 404506 405144 405687
 406550 407094 407725 408116 408998 409699 410204 410973 411525 412118
 412832 413519 413760 414940 415531 416361 417101 418220 418555 419184
 420041 420521 420996 421760 422582 423419 424416 424988 425893 426195
 427018 427775 428826 430083 430848 431656 432408 432806 433883 434557
 435052 435602 436519 437779 438119 438699 439414 440427 441103 441819
 442266 442801 443679 444244 444664 445919 446977 447462 448111 448516
 449292 449646 450659 450880 451300 451892 452548 453182 454000 454736
 455252 456509 456834 457436 458287 458785 459445 460083 460976 461753
 462659 463382 464173 464826 466445 468002 468512 469120 469749 471417
 471852 473079 474329 475122 475648 476442 476721 477538 478619 480077
 481029 482314 482923 483432 484292 484692 485933 486382 487343 488194
 489011 489821 490638 491456 491681 492013 492902 494234 495586 497145
 498304 498539 499969 501540 502609 502816 503594 504301 504888 505339
 505547 506266 507304 508737 509086 510061 510613 511392 511974 512466
 513446 514135 514640 515250 515760 516220 516471 516921 517849 518562
 519757 520481 521091 521893 522304 523363 523839 524431 525349 526152
 526884 527568 528670 529380 529475 529908 530500 530930 531296 531575
 532123 533348 533980 535187 536328 536969 537745 539042 539902 540973
 541500 542186 542968 543946 544579 545455 546393 546567 547409 548012
 548693 549802 550260 551225 552079 552339 553004 553877 554610 555172
 555710 556419 557040 557479 558827 559479 560039 560658 561246 562305
 563116 563710 564240 565047 565492 565956 567086 567688 568864 569415
 570469 571711 572917 573922 574877 575135 576356 577174 577876 579139
 580999 581281 581759 582750 583187 584345 585188 586016 586506 586868
 587744 588672 589066 589869 591156]
shape of X : (2273360, 68)
train_idx : 2272615
val_idx : 745
val_idx : [ 591660  592435  593099  593976  594795  595841  596655  597384  598015
  598672  599208  599810  600164  601194  601468  602379  602617  603397
  604143  604681  605428  605786  606581  607160  608309  608655  609927
  610275  610626  610874  611496  612050  613327  614136  615341  616154
  617059  617669  618488  619750  619972  620783  621383  622454  623624
  624890  625888  626504  627411  628166  628929  629520  629903  630386
  630581  631850  632434  633658  634670  635674  636913  637513  638444
  639056  639221  639673  640277  641552  642478  643642  644104  645668
  646317  647267  647645  649142  649414  650484  651272  651939  652970
  653446  653909  654772  655865  656405  656666  657491  657912  658594
  659114  659365  660221  660510  661600  662725  663176  664122  664988
  665289  666521  666881  667181  667893  669624  670194  671005  671639
  672012  672411  673438  673898  674375  675383  676008  676558  677561
  678098  678643  679050  679864  680402  680907  681577  682608  682845
  683801  684223  684686  685734  686114  686844  687516  688649  689525
  690110  690696  692011  692721  693355  693882  695211  695392  695769
  696031  696805  697840  698884  699916  700894  701278  702058  702942
  703251  703515  704237  705829  706506  707376  707932  708213  708433
  709117  709766  710747  711182  712265  712485  713423  714684  715274
  715988  716725  717204  718066  718784  719760  720069  720788  721473
  722499  724272  725287  725636  726650  727287  727901  728716  729250
  730988  731517  732359  732905  733411  733818  734707  735515  736244
  736703  737389  738338  738522  739477  740476  740939  742399  742806
  743329  744028  745140  745646  746684  747397  748517  748961  749899
  750694  751138  752216  752620  753464  754159  755053  755659  756074
  756600  756976  757824  758214  759055  760010  760713  760954  761331
  761581  761866  762507  763350  764349  764784  765210  765832  766326
  766933  767648  768667  769430  770097  770601  771253  771708  772609
  773224  773629  774580  775119  776120  776916  777471  778456  779265
  779731  780378  780707  781043  781447  782291  782776  783686  784447
  785334  786470  787079  787675  787981  789012  790158  791037  791635
  792468  793169  793950  794840  795437  796341  796655  797316  797860
  798277  799036  799985  800828  802054  802838  803678  804094  804590
  805258  805914  806397  806812  807367  808227  808967  809376  809798
  810822  812176  812870  813869  814538  815029  815690  816377  817575
  818039  819135  819847  821188  821860  822475  823840  824304  824707
  825650  826149  826782  827263  827615  828444  829163  829714  830504
  831346  832382  833113  833790  834736  835339  836040  836664  837144
  837823  838745  839360  840446  841106  841209  841852  842388  842932
  843809  844737  845172  845885  846987  848197  849323  849555  850281
  850710  851430  851565  852030  852463  853074  854059  855836  856545
  857487  857985  859091  859552  859818  860545  861383  862344  862702
  863612  864504  864879  866182  866928  867947  868303  869129  870022
  870436  871097  871772  872407  872738  873393  874420  874882  875315
  875690  876787  877373  877859  878616  879528  880140  880709  881568
  881789  882304  883546  884236  885097  885522  886581  887374  887866
  888225  888645  889206  889398  889770  891114  891909  892376  892848
  893398  894303  894701  894924  895923  896280  897133  898073  898767
  899442  899938  900429  901186  902052  902420  903657  904514  904831
  905381  905990  906605  907501  908503  909235  910007  910957  912442
  913413  914089  914603  915245  915786  916777  917670  918064  919395
  920095  920431  921288  922059  922588  922850  923685  924331  924586
  925156  925920  926423  927183  927821  928223  928822  929810  930360
  930789  931643  931961  932446  933270  933802  934652  935367  936171
  936376  937277  938043  939018  939969  940997  941817  942849  943292
  943957  944765  945375  945989  946677  947837  948275  949006  949650
  950493  951068  951843  952756  953435  954704  955294  955979  956642
  957177  957821  958905  959049  959760  960733  961086  961660  962085
  962777  963112  963872  964424  964792  965222  966439  966742  967542
  968214  968705  969775  970157  971006  971822  972789  973446  974601
  974958  975388  975968  976503  977007  977690  978186  979330  980635
  981755  982034  982405  982945  983196  983530  984109  984874  985041
  985774  986362  986857  987747  988290  989378  989990  991007  991502
  992168  992514  993172  993933  994707  995200  995994  996610  997140
  998299  999291 1000345 1000993 1001645 1002728 1003492 1003960 1004911
 1005284 1005824 1006594 1006895 1007577 1008043 1009155 1009958 1010800
 1011213 1011801 1012566 1013055 1013533 1014682 1015475 1015949 1016465
 1017843 1018650 1018753 1019213 1020042 1020393 1020938 1021652 1021978
 1022408 1023145 1023666 1024572 1025525 1026162 1026487 1027533 1028062
 1028824 1029874 1030596 1031029 1031306 1032421 1033210 1033747 1034267
 1034570 1035228 1035999 1036924 1037829 1038628 1038973 1040532 1040980
 1041852 1042666 1043387 1043779 1043940 1044549 1045487 1046172 1046570
 1047130 1048148 1048718 1049967 1050391 1050594 1051619 1052629 1053421
 1054119 1054548 1054923 1056026 1056762 1057197 1058238 1058673 1059169
 1059498 1059825 1060136 1061180 1061735 1061893 1062498 1062942 1063286
 1063725 1064300 1065028 1065760 1066440 1067266 1067587 1068025 1068504
 1069015 1069674 1070129 1070590 1071339 1071478 1071835 1072623 1073293
 1073903 1074379 1074957 1075295 1076044 1076612 1077204 1077690 1079358
 1079660 1080473 1080773 1081694 1082105 1082416 1083200 1083758 1084031
 1084662 1085409 1085853 1086701 1087268 1087904 1088530 1089502 1090308
 1090829 1091398 1092247 1092688 1093550 1094373 1094919 1095674 1096784
 1097488 1098576 1099001 1100303 1100728 1102360 1102685 1103653 1104044
 1104584 1105928 1106426 1106944 1107457 1108202 1108600]
shape of X : (2273360, 68)
train_idx : 2272616
val_idx : 744
val_idx : [1109795 1110473 1111373 1111971 1112318 1113245 1113389 1114164 1114879
 1115438 1116549 1116665 1116960 1117732 1118197 1118993 1120011 1120688
 1121155 1121607 1122256 1122886 1123614 1124194 1125225 1125928 1126902
 1127803 1128553 1129215 1129700 1130111 1130667 1131015 1131994 1132966
 1133408 1133726 1134459 1134755 1135640 1136496 1136846 1137562 1138627
 1139346 1139643 1139852 1140404 1141178 1142326 1142930 1143296 1143882
 1144916 1145320 1146169 1146741 1147453 1147899 1148497 1149022 1149329
 1149938 1150397 1151304 1152037 1152492 1152911 1153355 1153642 1154135
 1154457 1155743 1156199 1156489 1157047 1157577 1157917 1158542 1159125
 1160118 1160885 1161632 1162782 1163602 1164556 1165212 1165982 1166386
 1167324 1167568 1168265 1168487 1168893 1169106 1169800 1170496 1171108
 1171312 1172028 1172612 1173092 1173712 1174636 1175046 1175579 1175787
 1176791 1177224 1178961 1179515 1179754 1180377 1180982 1181185 1181917
 1182732 1183289 1183843 1184914 1185391 1185956 1186350 1186888 1187591
 1188034 1188443 1188932 1189333 1190169 1191210 1191626 1192575 1192794
 1193380 1194053 1194320 1195060 1196056 1197159 1197641 1198283 1198415
 1198700 1199213 1199685 1199939 1200406 1201388 1201952 1202768 1203430
 1204027 1204704 1205860 1206569 1206913 1207653 1208458 1208599 1208857
 1209335 1210357 1211357 1211797 1212298 1212768 1213887 1214106 1214494
 1214859 1215441 1215851 1216534 1217044 1217974 1218438 1218661 1219172
 1219683 1220460 1220708 1220993 1221500 1221932 1222703 1223192 1223745
 1224296 1224555 1225203 1225772 1226314 1227332 1228002 1228264 1228959
 1229620 1230301 1230596 1231028 1231464 1231777 1232606 1232990 1233303
 1233934 1234517 1234806 1235143 1235611 1236026 1236879 1237175 1238130
 1238604 1239574 1240038 1240604 1241347 1241867 1242111 1242445 1243030
 1243442 1244175 1244759 1244928 1245457 1246403 1246734 1247322 1248120
 1249074 1249596 1250007 1250626 1251466 1252125 1252684 1252975 1253561
 1253938 1254424 1255066 1255331 1255762 1255880 1256810 1257285 1258105
 1258420 1259482 1260220 1260902 1261616 1262031 1263475 1264063 1265290
 1265724 1266121 1267183 1267833 1268724 1269314 1269774 1270100 1270584
 1271556 1272031 1272609 1273398 1273971 1274115 1275016 1275879 1276182
 1276715 1277440 1278148 1279385 1279675 1280271 1281108 1281691 1282218
 1282969 1283353 1284105 1284867 1284951 1285920 1286454 1287335 1287782
 1288511 1289689 1290372 1290653 1291520 1291797 1292196 1293159 1293440
 1294152 1294498 1295000 1295579 1296136 1297213 1297970 1298360 1298651
 1299370 1300240 1300710 1301857 1302463 1303086 1303412 1304274 1304753
 1305479 1306130 1307226 1307755 1308234 1308724 1309442 1310230 1311199
 1311982 1312081 1312756 1313385 1313659 1314416 1315250 1316547 1317549
 1317894 1318252 1318834 1319309 1320112 1320716 1321063 1321354 1321475
 1322289 1323112 1323805 1324467 1324754 1325253 1325565 1326264 1326580
 1326959 1327474 1328386 1328940 1329353 1330063 1330499 1330886 1331577
 1331942 1333006 1333609 1334106 1334314 1335458 1335801 1335947 1336203
 1337267 1338082 1338557 1338738 1340144 1341052 1341534 1341722 1342236
 1342869 1343368 1343856 1344302 1344522 1344931 1345087 1345528 1346137
 1346741 1347393 1347867 1348095 1348716 1349369 1349651 1350482 1350984
 1351239 1352189 1352419 1353266 1354141 1354456 1354835 1355654 1356068
 1356560 1357165 1357634 1358638 1359098 1359438 1359846 1360279 1361311
 1362209 1363189 1363405 1363866 1364281 1365167 1365622 1366078 1366788
 1367349 1367701 1368376 1368434 1369039 1369452 1369807 1370158 1370950
 1371780 1372092 1372608 1373562 1374296 1374819 1375398 1376026 1376387
 1376798 1377214 1377432 1377626 1378241 1379061 1379298 1379536 1380089
 1381054 1381821 1382414 1382628 1383143 1383616 1384157 1384752 1385343
 1386091 1386505 1386795 1387472 1388031 1388391 1388506 1389116 1389824
 1391142 1391465 1392124 1392784 1393743 1393921 1394616 1395085 1395254
 1395632 1395982 1397425 1397789 1398157 1398622 1398938 1399149 1399441
 1399802 1400192 1400759 1401168 1401559 1402602 1403210 1403781 1404247
 1404776 1405018 1405439 1406379 1406665 1407176 1407499 1408163 1408586
 1409346 1409981 1411001 1411527 1412332 1412731 1412974 1413749 1414374
 1414960 1415399 1415623 1416132 1416680 1416824 1417387 1418216 1418654
 1418825 1419696 1420731 1420981 1421400 1422052 1422553 1422801 1423194
 1423485 1424249 1424480 1425088 1425591 1426483 1426861 1427539 1428011
 1428319 1428673 1428820 1429208 1429544 1430038 1430312 1431041 1431462
 1431752 1432559 1433127 1433556 1434100 1434966 1435092 1435630 1436109
 1436292 1436850 1437326 1437733 1438457 1438997 1439265 1439958 1440185
 1440372 1440752 1441939 1442361 1442854 1443382 1444049 1444828 1445804
 1446808 1447471 1448553 1449445 1449987 1450841 1451300 1451954 1452699
 1453091 1453417 1453781 1454128 1454666 1455099 1455501 1456558 1456985
 1457099 1457639 1458473 1459185 1459656 1460060 1460485 1460733 1461250
 1461686 1462084 1462640 1463198 1463541 1464135 1464915 1465456 1466167
 1466906 1467393 1468134 1468766 1469170 1469853 1470309 1470798 1471381
 1472194 1472978 1473334 1473867 1474156 1474577 1475288 1475582 1475986
 1476507 1477118 1477299 1477826 1478234 1478472 1479249 1480099 1480325
 1481487 1481881 1482437 1482708 1483225 1483782 1484501 1485282 1485676
 1486375 1486529 1486764 1487237 1487615 1488125 1488986 1489787 1490152
 1490449 1490756 1491147 1491449 1491867 1492306 1492829 1493891 1494520
 1494780 1495542 1495890 1496559 1497320 1497764 1498389 1499186 1499675
 1500267 1500809 1501181 1502001 1503023 1503428 1503851 1504405 1505108
 1505488 1506069 1506776 1507174 1507522 1507935 1508678 1508994 1509879
 1510573 1511260 1511739 1512240 1512633 1513295 1513608 1513866 1514407
 1514944 1515157 1515476 1516099 1516395 1517124 1517799 1518404 1518799
 1519103 1519460 1519925 1520251 1520933 1521341 1521708 1522536 1522689
 1523171 1523876 1524820 1525480 1526137 1526778 1527290 1528133 1528521
 1529391 1530093 1530347 1530808 1531148 1531827]
shape of X : (2273360, 68)
train_idx : 2272616
val_idx : 744
val_idx : [1532375 1532873 1533811 1534222 1534464 1535056 1535248 1536309 1537458
 1538133 1538481 1538994 1539383 1539803 1540531 1541077 1541379 1542056
 1543055 1543475 1544082 1544288 1544838 1545357 1545601 1545953 1546299
 1546634 1546914 1547339 1547692 1548159 1548458 1549140 1549859 1550268
 1550930 1551304 1551818 1552263 1553119 1553566 1554084 1554606 1555305
 1555716 1556024 1556348 1556574 1556891 1557369 1558121 1558734 1559089
 1559739 1560319 1560949 1561179 1561566 1561956 1562407 1562992 1563715
 1564406 1564650 1565205 1565423 1566051 1566525 1566805 1567257 1567826
 1568884 1569458 1569931 1570497 1570860 1571302 1571967 1572613 1573017
 1573224 1573668 1574035 1574896 1575294 1575893 1576040 1576394 1576736
 1577016 1577338 1577524 1578116 1578759 1579564 1580015 1580621 1581092
 1581533 1582188 1582968 1583703 1584555 1585049 1585720 1586295 1587174
 1587951 1588299 1588846 1589545 1589877 1590146 1590558 1591201 1591698
 1591801 1592595 1593283 1593637 1593970 1594481 1595149 1595344 1595911
 1596302 1597078 1598055 1598260 1598522 1598637 1599029 1599234 1599790
 1600330 1600824 1601324 1601756 1602113 1602587 1603368 1603957 1604448
 1604746 1605031 1605965 1606605 1607107 1607448 1608035 1608462 1608788
 1609618 1609915 1610225 1610983 1611726 1612195 1612493 1612729 1613219
 1614499 1615079 1615266 1615834 1616339 1616888 1617512 1618091 1618510
 1618696 1619359 1619997 1620999 1621447 1622273 1622627 1623262 1623701
 1623934 1624354 1624628 1624886 1625324 1625952 1626438 1626918 1627214
 1628154 1628432 1628957 1629370 1630291 1630937 1631382 1631653 1632224
 1632685 1633030 1633840 1634062 1634662 1634812 1634864 1635477 1636464
 1636759 1637539 1637731 1638586 1639230 1639601 1640000 1640608 1640955
 1641437 1642331 1642916 1643166 1643759 1644010 1644186 1644464 1644665
 1645173 1645410 1645720 1645924 1646378 1646627 1646869 1647588 1648000
 1648668 1648978 1649304 1649916 1650789 1651190 1651553 1651871 1652581
 1653203 1653711 1654222 1655187 1655771 1655908 1656743 1657746 1658304
 1658815 1659125 1659521 1660225 1660637 1660895 1661341 1662154 1662621
 1662973 1663121 1663660 1664011 1664502 1665076 1665487 1665711 1666299
 1666714 1667395 1667801 1668169 1668525 1668850 1669230 1669673 1670008
 1670205 1670604 1671136 1671844 1672346 1672761 1673056 1673650 1674046
 1674237 1674681 1675062 1675863 1676098 1676308 1676651 1677107 1677895
 1678290 1678848 1679248 1680062 1680700 1680957 1681307 1681439 1682027
 1682780 1683115 1683844 1684355 1685086 1685293 1685635 1686227 1686984
 1687276 1687571 1688095 1688635 1689027 1689554 1689942 1690285 1690644
 1691887 1692847 1693348 1693653 1694185 1694495 1694687 1695133 1695385
 1695818 1696000 1696798 1697204 1697539 1698165 1698781 1699010 1699640
 1699728 1700445 1700843 1701228 1701878 1702261 1702804 1703240 1703813
 1704188 1704692 1704816 1705046 1705078 1705464 1705840 1705946 1706224
 1706613 1707474 1708011 1708418 1708778 1708932 1709506 1709962 1710234
 1710548 1710921 1711296 1711416 1711866 1712300 1712464 1712997 1713337
 1713582 1713889 1714084 1714869 1715283 1715632 1716436 1716779 1717039
 1717738 1718420 1718714 1719094 1719404 1720051 1720386 1720803 1721216
 1721446 1721693 1721973 1722269 1722680 1723220 1723583 1724233 1724904
 1725085 1725402 1726094 1726380 1726860 1727333 1727908 1728214 1728654
 1729159 1729350 1729927 1730028 1730267 1730845 1731558 1731953 1732896
 1733432 1734160 1734593 1735457 1736011 1736314 1736936 1737241 1738182
 1738501 1739210 1739405 1739590 1740038 1740451 1741048 1741480 1741710
 1741921 1742374 1742716 1743417 1743747 1744029 1744168 1744697 1745106
 1745340 1746047 1746715 1747230 1747702 1747960 1748332 1748764 1749133
 1749545 1749891 1750090 1750363 1750680 1751756 1752255 1752839 1753137
 1754102 1754320 1754769 1755526 1756185 1756559 1757230 1757832 1758252
 1758548 1759265 1759885 1760267 1761099 1761342 1761838 1762460 1763031
 1763415 1764021 1764570 1764892 1765677 1765864 1766250 1766576 1766804
 1767476 1767911 1768762 1769219 1769864 1770249 1770853 1771348 1772091
 1772321 1772606 1772944 1773262 1773607 1773774 1774050 1774424 1775092
 1775519 1776158 1776814 1777613 1777748 1778106 1778996 1779330 1779556
 1779922 1780347 1780981 1781594 1781887 1782013 1782558 1782924 1783348
 1783665 1784004 1784299 1784723 1785010 1785395 1785618 1786421 1786922
 1787162 1787277 1787686 1788045 1788259 1788800 1789073 1789456 1789892
 1790241 1790332 1790824 1791165 1791530 1791941 1792211 1792683 1793599
 1794120 1794436 1794694 1794921 1795296 1796277 1796949 1797445 1797614
 1797910 1799160 1799738 1800373 1800468 1800644 1801360 1801631 1801866
 1802122 1802479 1803044 1803564 1803783 1804181 1804926 1805462 1806142
 1806614 1806845 1807047 1807561 1808112 1808528 1808978 1809453 1810055
 1810597 1810994 1811587 1811895 1812227 1812489 1812691 1813241 1813426
 1813898 1814427 1814880 1815274 1816104 1816503 1817267 1817474 1818078
 1818504 1819175 1819933 1820444 1820684 1820888 1821087 1821854 1822027
 1822238 1822421 1822776 1823108 1823324 1823779 1824077 1824314 1824522
 1824996 1825529 1826265 1826699 1827486 1827661 1828081 1828262 1828519
 1829088 1829561 1829767 1829843 1830220 1830440 1830877 1831071 1831711
 1832164 1832539 1833058 1833478 1833987 1834152 1834511 1834725 1835113
 1835347 1835712 1836259 1836465 1836559 1837281 1837633 1837830 1838003
 1838621 1839174 1839480 1839998 1840179 1840499 1841205 1841947 1842377
 1843122 1843785 1844254 1844743 1845179 1845729 1846051 1846194 1846889
 1847377 1847695 1848288 1848813 1848999 1849090 1849912 1850051 1850498
 1850747 1850945 1851508 1851698 1852127 1852584 1853076 1853752 1854317
 1854608 1854913 1855209 1855440 1856050 1856468 1856716 1856937 1857462
 1857786 1858150 1858505 1858891 1859285 1859919 1860438 1860862 1861404
 1861962 1862147 1862401 1862687 1862980 1863300 1863730 1864144 1864404
 1864800 1865165 1865383 1865591 1865913 1866594 1867103 1867583 1867896
 1868365 1868775 1869279 1869877 1870220 1870410]
shape of X : (2273360, 68)
train_idx : 2272616
val_idx : 744
val_idx : [1870866 1871534 1871877 1872294 1872642 1872911 1873888 1874504 1874817
 1875009 1875644 1876065 1876806 1877314 1878159 1878641 1878981 1879396
 1879960 1880492 1880877 1881138 1881422 1881765 1881953 1882581 1883016
 1883597 1884331 1884552 1884739 1885181 1885614 1885903 1886286 1886879
 1887307 1887621 1887947 1888066 1888506 1888896 1889441 1889983 1890799
 1891256 1891437 1891663 1891796 1891982 1892185 1892925 1893603 1893873
 1894118 1894381 1894828 1895038 1895452 1895702 1896121 1896351 1896503
 1896705 1897057 1897542 1897807 1898225 1898752 1898953 1899235 1900105
 1900968 1901389 1901696 1902387 1902669 1903480 1903852 1904105 1904594
 1905009 1905230 1905366 1905921 1906846 1907010 1907422 1907756 1908088
 1908426 1909126 1909627 1910115 1910814 1911007 1911131 1911294 1911941
 1912297 1912499 1912767 1913149 1913451 1913570 1914048 1914543 1914892
 1915102 1915475 1915744 1916078 1916594 1917210 1917696 1917829 1918148
 1918403 1918758 1919253 1919361 1920104 1920223 1920331 1920922 1921256
 1921579 1921786 1921935 1922380 1922918 1923220 1923360 1924010 1924546
 1925151 1925386 1925463 1926217 1926945 1927108 1927396 1927822 1928250
 1928541 1929144 1929465 1929843 1930456 1930629 1930976 1931193 1931406
 1931838 1932259 1932571 1933127 1933279 1933630 1933939 1934272 1934584
 1934943 1935549 1935792 1936305 1936435 1936741 1937066 1937378 1937587
 1938016 1938238 1938619 1939001 1939421 1939994 1940477 1940831 1941592
 1941942 1942676 1943153 1943573 1944006 1944433 1944767 1945270 1945483
 1946007 1946232 1946569 1947045 1947211 1947719 1948027 1948409 1948535
 1949140 1949376 1949532 1949733 1949855 1950507 1950745 1950979 1951141
 1951876 1951933 1952396 1952615 1953146 1953310 1953534 1954190 1954543
 1954697 1955084 1955478 1955876 1956279 1956682 1956788 1957088 1957572
 1957755 1958258 1958436 1958677 1958845 1959381 1959573 1960260 1960537
 1960821 1961026 1961107 1961430 1961781 1962220 1962405 1962707 1963112
 1963390 1963680 1963866 1963997 1964248 1964826 1965198 1965414 1965757
 1966207 1966413 1966834 1967198 1967373 1967525 1967968 1968087 1968422
 1968605 1968828 1969345 1969712 1970277 1970505 1970934 1971184 1971445
 1971792 1972094 1972397 1972870 1972978 1973408 1973530 1973880 1973993
 1974144 1974484 1974777 1975128 1975633 1975885 1976434 1976606 1977014
 1977264 1977715 1978022 1978398 1978686 1978978 1979511 1979689 1979997
 1980275 1980843 1981292 1981451 1981906 1982223 1982633 1982860 1983030
 1983127 1983769 1984220 1984666 1985330 1985716 1986174 1986385 1986728
 1987078 1987419 1987744 1988656 1988874 1989139 1989412 1989665 1990078
 1990477 1990806 1991103 1991347 1991614 1992015 1992485 1992746 1993224
 1993597 1994041 1994239 1994740 1994936 1995238 1995478 1995874 1996404
 1996687 1996966 1997423 1997524 1997760 1997978 1998301 1998419 1998969
 1999226 1999531 1999653 2000140 2000420 2000669 2000773 2000908 2001150
 2001435 2001640 2001882 2002062 2002338 2002861 2003581 2003984 2004119
 2004399 2004800 2004973 2005255 2005486 2005796 2006048 2006650 2006875
 2007335 2007752 2007931 2008241 2008473 2008798 2009094 2009293 2009764
 2010044 2010534 2010798 2010883 2011189 2011572 2011709 2011907 2012237
 2012490 2012621 2012727 2013095 2013507 2013735 2014037 2014419 2014892
 2015007 2015241 2015502 2015947 2016237 2016796 2017117 2017393 2017631
 2018281 2018699 2019189 2019551 2020251 2020361 2020659 2020878 2021065
 2021393 2021538 2021698 2021871 2022080 2022179 2022489 2022975 2023263
 2023674 2024012 2024169 2024684 2025000 2025128 2025329 2025612 2026155
 2026435 2026784 2026975 2027337 2027607 2028207 2028534 2028815 2029163
 2029672 2030311 2030646 2030932 2031121 2031374 2031515 2031965 2032186
 2032486 2032706 2033265 2033465 2033692 2034121 2034625 2034832 2035287
 2035471 2035866 2036170 2036603 2036934 2037341 2037982 2038348 2038806
 2039057 2039894 2040126 2040336 2040587 2040784 2041134 2041430 2041660
 2041999 2042385 2042689 2042818 2043057 2043154 2043405 2043692 2043884
 2044086 2044531 2044813 2045141 2045388 2045739 2046103 2046331 2046531
 2046829 2047469 2048025 2048198 2048861 2049371 2049432 2049843 2050132
 2050292 2050739 2051310 2051686 2051886 2052361 2052851 2053025 2053294
 2053484 2053626 2054087 2054492 2054813 2055353 2055788 2055979 2056227
 2056825 2057169 2057938 2058404 2058651 2059252 2059539 2059678 2059913
 2060014 2060263 2060655 2060829 2061544 2061792 2062092 2062590 2062808
 2063020 2063201 2063779 2064044 2064278 2064775 2064978 2065212 2065550
 2066074 2066403 2066791 2067052 2067457 2067546 2067832 2068133 2068334
 2068517 2068987 2069142 2069708 2069990 2070353 2070621 2070654 2070856
 2070975 2071303 2071584 2072052 2072403 2072658 2072958 2072996 2073301
 2073505 2073633 2073870 2074275 2074621 2074750 2074914 2075056 2075425
 2075843 2076059 2076393 2076430 2076651 2076821 2077151 2077573 2077748
 2077995 2078140 2078319 2078578 2078922 2079516 2079950 2080287 2080450
 2080719 2081588 2081692 2081903 2082117 2082530 2082690 2083000 2083164
 2083387 2083511 2083855 2084017 2084316 2084480 2084670 2085064 2085212
 2085465 2085658 2085740 2085905 2086048 2086379 2086585 2086723 2087018
 2087148 2087322 2087739 2087880 2088182 2088279 2088340 2088660 2089133
 2089265 2089402 2089701 2089964 2090272 2090635 2090892 2091029 2091220
 2091855 2092204 2092389 2092792 2093276 2094039 2094327 2094551 2094838
 2095096 2095573 2095726 2096162 2096395 2097158 2097563 2098017 2098485
 2098725 2098982 2099421 2099835 2100212 2100434 2100651 2101265 2101583
 2101981 2102259 2102551 2102845 2103219 2103395 2103877 2104017 2104334
 2104792 2104919 2105308 2105657 2105777 2105976 2106190 2106380 2106784
 2106982 2107148 2107414 2107929 2108119 2108347 2108553 2108884 2109147
 2109382 2109461 2109789 2110156 2110337 2110608 2110878 2111174 2111306
 2111731 2112097 2112153 2112331 2112575 2113023 2113139 2113590 2114101
 2114327 2114525 2114663 2114822 2115347 2115680 2115956 2116305 2116503
 2117066 2117694 2117762 2118001 2118249 2118509]
shape of X : (2273360, 68)
train_idx : 2272700
val_idx : 744
val_idx : [2118931 2119443 2119947 2120246 2120308 2120581 2121048 2121170 2121667
 2121989 2122302 2122814 2123081 2123369 2123637 2124137 2124651 2125051
 2125182 2125353 2125649 2125939 2126122 2126427 2126544 2126716 2127151
 2127213 2127655 2127998 2128185 2128643 2128764 2129206 2129507 2129757
 2130018 2130233 2130579 2130847 2131146 2131422 2131672 2131799 2131959
 2132345 2132489 2132748 2133119 2133549 2133733 2133941 2134236 2134911
 2135590 2135749 2135992 2136085 2136314 2136421 2136562 2136933 2137137
 2137306 2137395 2137720 2137847 2138315 2138769 2139140 2139372 2139640
 2139888 2140096 2140569 2140732 2140850 2141103 2141325 2141626 2141944
 2142306 2142546 2142790 2143104 2143265 2143396 2143673 2144197 2144720
 2145069 2145151 2145461 2145602 2145928 2146193 2146298 2146612 2146993
 2147131 2147337 2147655 2147840 2147973 2148093 2148341 2148528 2148694
 2149056 2149479 2149577 2149745 2149981 2150541 2150798 2151036 2151205
 2151387 2151636 2152066 2152330 2152580 2152810 2152908 2153031 2153494
 2153621 2153786 2153974 2154287 2154462 2154651 2154720 2155297 2155531
 2155697 2155891 2156074 2156501 2156751 2156917 2157134 2157514 2157780
 2158030 2158250 2158390 2158689 2158779 2158886 2159295 2159415 2159724
 2160013 2160285 2160453 2160709 2160953 2161262 2161450 2161554 2161735
 2162102 2162523 2162660 2163027 2163244 2163441 2163665 2164010 2164344
 2164569 2164640 2164940 2165265 2165534 2165805 2166263 2166460 2166640
 2166805 2167237 2167290 2167574 2168061 2168392 2168683 2168913 2169159
 2169604 2169742 2170115 2170164 2170321 2170552 2170682 2171032 2171125
 2171609 2171865 2172148 2172545 2172731 2173267 2173596 2173925 2174213
 2174326 2174645 2174841 2174951 2175245 2175498 2175649 2175801 2175967
 2176218 2176380 2176490 2176716 2177001 2177295 2177429 2177612 2178046
 2178234 2178727 2178982 2179148 2179286 2179503 2179780 2180096 2180342
 2180565 2180686 2180882 2181109 2181252 2181663 2182065 2182371 2182482
 2182565 2182764 2183071 2183174 2183429 2183665 2183914 2184043 2184318
 2184657 2184756 2184902 2185236 2185755 2186075 2186272 2186353 2186640
 2186895 2187117 2187374 2187921 2188002 2188240 2188306 2188466 2188581
 2188761 2189218 2189536 2189888 2190262 2190707 2190908 2191051 2191467
 2191727 2191933 2192367 2192604 2192845 2193065 2193247 2193403 2193529
 2193707 2193906 2194164 2194500 2194830 2195064 2195272 2195457 2195671
 2195746 2195835 2196097 2196296 2196480 2196632 2196726 2196786 2197039
 2197212 2197514 2197847 2197984 2198120 2198245 2198471 2198904 2199041
 2199183 2199542 2200113 2200294 2200542 2200645 2200925 2201154 2202040
 2202195 2202439 2202776 2203140 2203412 2203842 2203947 2204206 2204437
 2204712 2204984 2205068 2205243 2205374 2205632 2205733 2205867 2206063
 2206168 2206419 2206582 2206840 2207065 2207323 2207393 2207612 2207732
 2207831 2207894 2208101 2208562 2208979 2209106 2209356 2209432 2209740
 2209915 2210059 2210349 2210854 2210981 2211215 2211376 2211661 2211727
 2211851 2212415 2212650 2212877 2213070 2213273 2213480 2213624 2213992
 2214178 2214340 2214476 2214602 2214859 2214941 2215193 2215279 2215520
 2215886 2216019 2216345 2216559 2216843 2217217 2217443 2217709 2218011
 2218152 2218343 2218625 2218861 2218932 2219175 2219230 2219500 2219757
 2220038 2220203 2220366 2220620 2220731 2220926 2221109 2221266 2221562
 2221785 2222103 2222442 2222466 2222568 2222734 2223073 2223345 2223718
 2223961 2224344 2224795 2225036 2225209 2225341 2225519 2225691 2225778
 2226003 2226442 2226753 2226836 2226951 2227053 2227281 2227519 2227814
 2227886 2228045 2228379 2228724 2228967 2229105 2229333 2229730 2229976
 2230228 2230323 2230504 2230855 2231160 2231365 2231522 2231847 2232213
 2232568 2232706 2233083 2233236 2233470 2233716 2233771 2233859 2234063
 2234322 2234395 2234630 2234840 2234907 2235054 2235147 2235414 2235566
 2235686 2235886 2236193 2236401 2236580 2236794 2237007 2237373 2237847
 2238265 2238301 2238466 2238652 2238938 2239097 2239421 2239812 2239927
 2240184 2240324 2240685 2240793 2241307 2241422 2241806 2241947 2242267
 2242565 2242727 2242829 2242963 2243301 2243382 2243679 2243948 2244178
 2244410 2244640 2245013 2245396 2245625 2245749 2245876 2245995 2246069
 2246439 2246600 2246662 2246798 2247091 2247211 2247522 2247763 2247895
 2248203 2248242 2248667 2248846 2248981 2249086 2249367 2249764 2249968
 2250242 2250391 2250763 2251087 2251271 2251690 2251890 2252355 2252510
 2252877 2253056 2253266 2253355 2253489 2253740 2253930 2254221 2254435
 2254842 2254992 2255295 2255397 2255556 2255689 2255796 2256061 2256306
 2256428 2256554 2256623 2256803 2256935 2257126 2257270 2257352 2257549
 2257863 2258063 2258287 2258543 2258723 2258973 2259064 2259274 2259586
 2259669 2260221 2260490 2260698 2260842 2261061 2261171 2261443 2261575
 2261688 2262024 2262254 2262605 2262903 2263103 2263264 2263555 2263679
 2263801 2264021 2264241 2264369 2264561 2264808 2264933 2265051 2265195
 2265496 2265621 2265838 2265928 2266037 2266199 2266379 2266709 2266764
 2266912 2267112 2267219 2267273 2267357 2267770 2267874 2268050 2268189
 2268250 2268509 2268721 2269012 2269221 2269333 2269446 2269589 2269707
show more (open the raw output data in a text editor) ...

 2525736 2525753 2525775 2525790 2525805 2525824 2525839 2525854 2525869
 2525884 2525900 2525916 2525931 2525946 2525955]
shape of X : (2273360, 68)
valid Set이 된 모든 row들의 개수 : 7442
valid Set이 된 모든 row들 unique 개수 : 7442


IndexError: positional indexers are out-of-bounds
```

> 에러원인 발견
>
> - shape of X : (2273360, 68)인데 반하여 val_idx의 값이 2525955와 같이 범위를 벗어나있다.
> - X의 shape이 본래의 input인 df 객체보다 적은 이유는 pycaret의 setup에서 subsampling이 이루어지고 난 이후이기 때문이다.





## 2) 유라가 수정해준 코드

Input

```python
from functools import wraps
import warnings
import numbers

import numpy as np
import scipy.sparse as sp
from inspect import signature, isclass, Parameter

from sklearn.utils.validation import _num_samples, column_or_1d, _deprecate_positional_args
from sklearn.utils import check_random_state, _approximate_mode, indexable, _safe_indexing
from sklearn.model_selection import BaseCrossValidator
from abc import ABCMeta, abstractmethod


class _BaseKFold(BaseCrossValidator, metaclass=ABCMeta):
    """Base class for KFold, GroupKFold, and StratifiedKFold"""

    @abstractmethod
    @_deprecate_positional_args
    def __init__(self, n_splits, *, shuffle, random_state):
        if not isinstance(n_splits, numbers.Integral):
            raise ValueError('The number of folds must be of Integral type. '
                             '%s of type %s was passed.'
                             % (n_splits, type(n_splits)))
        n_splits = int(n_splits)

        if n_splits <= 1:
            raise ValueError(
                "k-fold cross-validation requires at least one"
                " train/test split by setting n_splits=2 or more,"
                " got n_splits={0}.".format(n_splits))

        if not isinstance(shuffle, bool):
            raise TypeError("shuffle must be True or False;"
                            " got {0}".format(shuffle))

        if not shuffle and random_state is not None:  # None is the default
            raise ValueError(
                'Setting a random_state has no effect since shuffle is '
                'False. You should leave '
                'random_state to its default (None), or set shuffle=True.',
            )

        self.n_splits = n_splits
        self.shuffle = shuffle
        self.random_state = random_state

    def split(self, X, y=None, groups=None):
        """Generate indices to split data into training and test set.
        Parameters
        ----------
        X : array-like of shape (n_samples, n_features)
            Training data, where n_samples is the number of samples
            and n_features is the number of features.
        y : array-like of shape (n_samples,), default=None
            The target variable for supervised learning problems.
        groups : array-like of shape (n_samples,), default=None
            Group labels for the samples used while splitting the dataset into
            train/test set.
        Yields
        ------
        train : ndarray
            The training set indices for that split.
        test : ndarray
            The testing set indices for that split.
        """
        X, y, groups = indexable(X, y, groups)
        n_samples = _num_samples(X)
        if self.n_splits > n_samples:
            raise ValueError(
                ("Cannot have number of splits n_splits={0} greater"
                 " than the number of samples: n_samples={1}.")
                .format(self.n_splits, n_samples))

        for train, test in super().split(X, y, groups):
            yield train, test

    def get_n_splits(self, X=None, y=None, groups=None):
        """Returns the number of splitting iterations in the cross-validator
        Parameters
        ----------
        X : object
            Always ignored, exists for compatibility.
        y : object
            Always ignored, exists for compatibility.
        groups : object
            Always ignored, exists for compatibility.
        Returns
        -------
        n_splits : int
            Returns the number of splitting iterations in the cross-validator.
        """
        return self.n_splits


# !! Works only when y is given !!
class LastSolveKFold(_BaseKFold):
    @_deprecate_positional_args
    def __init__(self, last_ids, n_splits=10, shuffle=False, random_state=None):
        super().__init__(n_splits=n_splits, shuffle=shuffle, random_state=random_state)
        self.last_ids = last_ids

    def _iter_test_indices(self, X, y=None, groups=None):
        n_samples = _num_samples(X)
        indices = np.arange(n_samples)
        if self.shuffle:
            check_random_state(self.random_state).shuffle(indices)

        n_splits = self.n_splits
        fold_sizes = np.full(n_splits, n_samples // n_splits, dtype=int)
        fold_sizes[:n_samples % n_splits] += 1
        current = 0
        for fold_size in fold_sizes:
            start, stop = current, current + fold_size
            yield indices[start:stop]
            current = stop

    def split(self, X, y=None, groups=None):
        X, y, groups =indexable(X, y, groups)
        indices = np.arange(_num_samples(X))
        for test_id in self._iter_test_masks(X, y, groups):
            train_index = indices[np.logical_not(test_id)]
            test_index = indices[test_id]
            test_index = np.intersect1d(test_index, self.last_ids)
            yield train_index, test_index

user_id = np.array(df['userID'])
last_ids = np.where(np.roll(user_id, shift=-1) != user_id)[0]
last_fold = LastSolveKFold(last_ids=user_id, n_splits=10, shuffle=True, random_state=42)  # shuffle=True,  random_state=42, 
```

Output (Error 없음)

```bash
train_idx : 2046024
train_idx : <class 'numpy.ndarray'>
val_idx : 799
val_idx : <class 'numpy.ndarray'>
val_idx : [  11   20   26   27   33   39   40   51   58   74   78   79   92  118
  127  136  138  148  151  153  162  173  178  197  240  251  258  270
  273  275  297  320  324  327  391  393  395  421  426  430  434  445
  459  475  477  479  501  506  520  537  555  562  567  577  583  593
  596  606  607  621  622  623  628  629  632  640  644  652  658  665
  672  685  696  704  721  722  724  749  750  771  774  776  795  822
  831  841  850  856  873  883  893  899  916  919  931  940  954  956
  967  969  970  974  978  991 1002 1009 1015 1032 1045 1049 1060 1068
 1075 1077 1086 1090 1093 1100 1116 1124 1131 1132 1141 1145 1150 1157
 1167 1168 1169 1174 1175 1178 1185 1213 1222 1271 1280 1290 1292 1295
 1318 1321 1332 1334 1341 1342 1344 1373 1381 1393 1394 1400 1406 1419
 1430 1434 1435 1441 1459 1462 1477 1485 1499 1500 1504 1525 1529 1530
 1534 1544 1553 1558 1570 1589 1592 1593 1608 1611 1637 1648 1657 1669
 1690 1693 1697 1698 1703 1713 1735 1744 1753 1760 1763 1771 1778 1793
 1808 1815 1816 1855 1857 1860 1864 1886 1887 1899 1906 1910 1922 1925
 1935 1939 1950 1954 1967 1976 1980 1988 1995 2002 2008 2016 2026 2027
 2030 2041 2052 2057 2059 2082 2090 2101 2103 2123 2126 2142 2167 2208
 2221 2223 2225 2233 2237 2244 2247 2255 2257 2260 2268 2275 2292 2304
 2309 2341 2342 2348 2357 2365 2366 2370 2371 2389 2390 2399 2400 2425
 2446 2464 2485 2492 2499 2502 2555 2573 2590 2592 2598 2601 2630 2635
 2640 2650 2651 2652 2696 2699 2704 2723 2725 2727 2730 2742 2784 2788
 2789 2790 2804 2829 2835 2843 2856 2869 2883 2888 2907 2914 2941 2945
 2947 2962 2974 2975 2981 3000 3001 3014 3028 3045 3061 3064 3073 3081
 3084 3087 3088 3092 3095 3101 3129 3138 3140 3145 3147 3148 3149 3153
 3163 3165 3166 3175 3178 3185 3201 3202 3204 3208 3215 3222 3225 3229
 3233 3244 3268 3272 3295 3298 3316 3322 3354 3368 3384 3388 3416 3417
 3426 3443 3449 3451 3455 3488 3494 3501 3508 3514 3518 3522 3524 3538
 3544 3553 3558 3575 3605 3608 3614 3620 3624 3638 3648 3655 3672 3678
 3682 3685 3690 3693 3698 3699 3707 3717 3721 3744 3746 3757 3780 3782
 3791 3799 3820 3836 3845 3853 3858 3862 3864 3876 3914 3918 3931 3954
 3975 3977 3978 3993 4000 4020 4024 4035 4074 4077 4078 4082 4091 4106
 4113 4119 4124 4125 4129 4174 4177 4179 4186 4189 4200 4208 4209 4218
 4230 4238 4265 4272 4278 4280 4282 4283 4287 4302 4303 4339 4352 4361
 4383 4386 4401 4402 4403 4416 4419 4423 4425 4434 4441 4447 4452 4456
 4465 4472 4474 4480 4482 4483 4488 4491 4497 4500 4511 4522 4524 4525
 4534 4537 4547 4548 4550 4557 4558 4565 4572 4578 4582 4583 4585 4591
 4598 4607 4621 4625 4628 4656 4663 4668 4686 4689 4692 4695 4696 4717
 4723 4736 4748 4758 4759 4784 4805 4817 4829 4843 4855 4870 4885 4888
 4889 4891 4897 4899 4900 4918 4933 4954 5002 5029 5034 5035 5038 5043
 5044 5047 5052 5066 5067 5069 5072 5073 5074 5112 5115 5120 5132 5158
 5163 5175 5184 5185 5198 5203 5218 5222 5227 5244 5259 5261 5268 5273
 5276 5292 5300 5306 5309 5320 5348 5351 5357 5370 5384 5386 5397 5398
 5402 5407 5408 5416 5436 5450 5476 5478 5483 5498 5501 5509 5510 5524
 5529 5533 5535 5538 5545 5552 5561 5563 5573 5591 5605 5614 5615 5617
 5623 5630 5639 5644 5648 5658 5668 5670 5671 5681 5708 5716 5732 5735
 5746 5760 5762 5763 5771 5784 5786 5795 5816 5839 5858 5860 5870 5896
 5923 5935 5962 5994 5999 6002 6006 6043 6044 6049 6051 6061 6067 6072
 6075 6079 6090 6096 6102 6125 6136 6138 6146 6155 6165 6168 6196 6201
 6208 6211 6223 6234 6243 6272 6275 6278 6293 6324 6337 6339 6353 6359
 6375 6380 6393 6396 6397 6407 6408 6421 6424 6428 6436 6442 6447 6451
 6459 6469 6471 6506 6534 6546 6557 6568 6571 6574 6582 6587 6609 6610
 6621 6623 6633 6644 6648 6665 6678 6682 6684 6708 6729 6731 6735 6746
 6752 6756 6760 6761 6777 6782 6786 6817 6864 6869 6874 6875 6898 6900
 6906 6908 6913 6937 6945 6960 6967 6983 7012 7023 7029 7033 7064 7073
 7079 7094 7098 7109 7126 7132 7137 7142 7147 7151 7160 7165 7174 7179
 7190 7227 7236 7241 7249 7250 7252 7253 7266 7268 7316 7319 7326 7328
 7332 7341 7343 7358 7367 7372 7376 7378 7391 7392 7393 7416 7419 7423
 7441]
shape of X : (2273360, 68)
train_idx : 2046024
train_idx : <class 'numpy.ndarray'>
val_idx : 740
val_idx : <class 'numpy.ndarray'>
val_idx : [   1   12   24   29   31   36   43   47   50   87  100  111  122  163
  175  177  185  186  195  207  222  231  232  235  243  246  259  274
  276  279  312  313  321  328  333  335  380  403  413  416  417  428
  436  442  463  490  499  513  515  541  545  554  558  609  616  618
  626  660  667  673  674  680  694  725  728  745  757  763  783  787
  804  824  839  863  864  886  924  939  941  955  960  964  971  980
  993  995 1014 1016 1017 1028 1033 1039 1065 1088 1114 1117 1147 1151
 1158 1160 1164 1166 1171 1172 1181 1187 1194 1199 1210 1212 1238 1251
 1256 1278 1284 1289 1296 1320 1322 1350 1356 1358 1359 1365 1366 1377
 1385 1389 1403 1411 1413 1420 1421 1425 1451 1455 1473 1479 1507 1531
 1536 1541 1549 1552 1562 1568 1598 1599 1602 1603 1616 1617 1619 1621
 1636 1638 1666 1672 1680 1684 1706 1721 1726 1748 1758 1764 1765 1781
 1783 1785 1787 1788 1814 1831 1835 1846 1847 1858 1863 1878 1890 1898
 1905 1923 1941 1957 1966 1985 1987 1997 2009 2012 2018 2020 2023 2024
 2034 2047 2050 2069 2072 2119 2138 2158 2169 2199 2201 2209 2220 2229
 2230 2232 2238 2252 2256 2266 2272 2276 2290 2296 2321 2326 2331 2339
 2343 2347 2361 2363 2381 2395 2401 2402 2408 2421 2431 2437 2445 2458
 2460 2461 2462 2469 2472 2479 2508 2549 2558 2559 2561 2566 2585 2593
 2604 2605 2609 2613 2633 2636 2664 2673 2676 2687 2692 2709 2722 2734
 2737 2739 2745 2756 2767 2771 2785 2811 2814 2819 2827 2836 2839 2840
 2851 2870 2871 2877 2882 2890 2911 2915 2919 2933 2936 2943 2958 2965
 2966 2976 2978 2980 2986 2987 2994 3009 3016 3035 3055 3070 3078 3104
 3113 3119 3120 3121 3127 3135 3143 3151 3160 3184 3205 3207 3216 3223
 3238 3241 3243 3247 3248 3251 3253 3257 3259 3284 3304 3323 3325 3326
 3351 3364 3380 3391 3395 3399 3457 3469 3473 3474 3491 3509 3512 3529
 3530 3533 3545 3550 3568 3571 3580 3581 3592 3604 3607 3615 3618 3636
 3653 3688 3696 3700 3711 3731 3739 3748 3777 3789 3810 3812 3816 3827
 3830 3837 3850 3869 3883 3898 3916 3937 3944 3951 3957 3962 3964 3965
 3982 3983 4014 4031 4040 4042 4044 4055 4090 4094 4107 4116 4123 4126
 4132 4143 4151 4157 4162 4172 4178 4185 4194 4205 4224 4239 4249 4258
 4270 4273 4288 4306 4323 4324 4333 4336 4376 4387 4396 4405 4413 4421
 4426 4436 4440 4443 4450 4485 4493 4498 4535 4540 4541 4543 4561 4563
 4570 4594 4595 4618 4636 4643 4661 4666 4667 4669 4672 4674 4681 4710
 4712 4719 4721 4729 4743 4751 4756 4762 4783 4800 4809 4813 4838 4840
 4872 4873 4901 4909 4922 4923 4924 4945 4946 4957 4988 4998 5005 5006
 5013 5021 5022 5027 5039 5042 5057 5065 5079 5081 5086 5111 5122 5124
 5126 5147 5159 5162 5167 5171 5189 5193 5196 5204 5205 5210 5229 5280
 5281 5296 5307 5332 5339 5345 5356 5364 5367 5369 5373 5374 5379 5388
 5394 5423 5425 5431 5434 5438 5451 5460 5467 5479 5480 5490 5496 5497
 5506 5528 5540 5541 5551 5553 5565 5583 5585 5588 5592 5600 5601 5606
 5616 5628 5641 5642 5654 5655 5664 5673 5685 5690 5704 5707 5710 5717
 5723 5727 5744 5750 5755 5783 5793 5800 5801 5809 5844 5855 5879 5913
 5914 5916 5925 5952 5956 5959 5995 5996 6018 6037 6042 6069 6078 6084
 6092 6116 6118 6121 6131 6139 6140 6148 6173 6206 6217 6218 6219 6228
 6230 6237 6252 6256 6263 6266 6267 6268 6270 6292 6299 6301 6322 6330
 6331 6342 6378 6385 6387 6388 6390 6403 6410 6419 6434 6443 6445 6454
 6457 6473 6514 6521 6542 6549 6550 6573 6581 6584 6585 6593 6597 6600
 6632 6650 6667 6675 6676 6679 6702 6710 6720 6723 6727 6737 6738 6743
 6750 6751 6764 6791 6804 6811 6814 6821 6827 6828 6846 6854 6931 6940
 6950 6958 6971 6978 6981 6985 6989 7002 7008 7016 7024 7049 7068 7088
 7102 7104 7105 7115 7118 7135 7136 7138 7146 7154 7156 7159 7162 7169
 7194 7204 7220 7229 7235 7246 7257 7259 7271 7275 7276 7281 7289 7294
 7298 7299 7311 7315 7347 7349 7354 7361 7388 7395 7412 7421]
shape of X : (2273360, 68)
train_idx : 2046024
train_idx : <class 'numpy.ndarray'>
val_idx : 665
val_idx : <class 'numpy.ndarray'>
val_idx : [   3    5   23   42   52   55   67   72   80   94  105  125  130  139
  158  169  180  189  196  198  199  213  219  229  236  237  261  288
  292  299  314  315  325  349  355  358  364  369  370  371  382  396
  425  437  448  451  452  457  458  470  489  494  497  526  533  538
  539  540  543  546  550  551  552  564  586  627  657  669  675  683
  698  714  715  737  748  766  779  782  784  786  788  813  816  829
  846  847  859  894  904  906  948  959  965  976 1020 1036 1070 1073
 1079 1084 1092 1095 1098 1109 1115 1123 1137 1154 1156 1205 1236 1242
 1244 1260 1268 1279 1285 1291 1305 1312 1325 1326 1352 1369 1443 1454
 1469 1474 1481 1483 1505 1516 1518 1524 1526 1537 1551 1559 1569 1574
 1575 1582 1583 1627 1629 1633 1661 1667 1681 1685 1687 1711 1715 1720
 1733 1739 1750 1766 1777 1780 1817 1819 1833 1837 1856 1867 1885 1892
 1956 1959 1984 2007 2014 2017 2042 2056 2071 2091 2093 2125 2135 2157
 2160 2168 2184 2189 2194 2196 2218 2245 2249 2258 2283 2286 2289 2297
 2307 2311 2312 2315 2354 2356 2392 2403 2413 2419 2434 2439 2440 2454
 2457 2466 2478 2496 2500 2501 2503 2516 2534 2546 2567 2575 2586 2595
 2612 2619 2623 2626 2637 2646 2654 2665 2684 2690 2691 2701 2721 2726
 2729 2752 2774 2791 2803 2809 2816 2837 2838 2850 2867 2876 2889 2893
 2899 2926 2930 2939 2940 2950 2969 2998 3003 3011 3013 3027 3032 3044
 3048 3049 3054 3057 3068 3089 3115 3116 3152 3167 3168 3176 3210 3221
 3228 3231 3246 3275 3287 3288 3292 3306 3319 3330 3336 3339 3340 3357
 3358 3367 3394 3404 3418 3423 3428 3434 3444 3475 3479 3483 3484 3489
 3495 3497 3502 3506 3507 3526 3541 3543 3566 3586 3594 3606 3610 3622
 3632 3645 3656 3694 3701 3712 3713 3722 3724 3730 3753 3760 3769 3770
 3788 3811 3818 3819 3841 3867 3868 3872 3880 3889 3891 3892 3897 3909
 3920 3922 3927 3939 3942 3946 3947 3952 3955 3971 3976 3986 3990 3997
 3998 4021 4022 4030 4033 4037 4049 4057 4059 4067 4076 4081 4096 4101
 4105 4154 4166 4181 4182 4187 4210 4215 4221 4231 4232 4235 4243 4250
 4259 4263 4281 4293 4295 4296 4317 4338 4344 4350 4363 4370 4389 4424
 4431 4435 4458 4463 4467 4476 4484 4486 4505 4520 4521 4523 4559 4564
 4568 4574 4584 4588 4590 4612 4615 4626 4637 4641 4658 4664 4679 4687
 4703 4704 4713 4753 4757 4765 4775 4789 4794 4798 4811 4839 4845 4846
 4857 4860 4886 4898 4927 4950 4968 4970 4982 5009 5011 5012 5019 5031
 5054 5093 5094 5101 5105 5117 5121 5130 5131 5135 5139 5142 5143 5151
 5152 5153 5161 5177 5180 5182 5206 5221 5230 5234 5237 5238 5250 5282
 5302 5341 5368 5372 5385 5387 5410 5427 5430 5447 5465 5481 5482 5484
 5500 5527 5537 5548 5559 5562 5564 5571 5595 5607 5612 5622 5629 5638
 5645 5669 5687 5701 5706 5733 5753 5764 5766 5787 5791 5813 5830 5843
 5872 5875 5878 5906 5911 5955 5965 5984 5993 6001 6008 6014 6032 6033
 6057 6071 6082 6098 6107 6110 6115 6127 6128 6143 6154 6160 6161 6162
 6176 6183 6200 6204 6207 6216 6227 6247 6255 6258 6277 6281 6302 6310
 6317 6328 6346 6348 6350 6357 6366 6374 6376 6379 6409 6420 6425 6438
 6450 6465 6468 6470 6478 6484 6488 6490 6499 6551 6563 6572 6580 6607
 6625 6627 6652 6655 6663 6689 6693 6716 6754 6757 6765 6776 6779 6784
 6798 6803 6808 6815 6822 6840 6845 6848 6861 6867 6878 6894 6909 6921
 6938 6942 6943 6944 6946 6957 6972 6973 6994 7020 7043 7046 7067 7069
 7084 7085 7153 7171 7219 7232 7255 7267 7279 7305 7317 7325 7356 7359
 7394 7396 7407 7415 7433 7434 7438]
shape of X : (2273360, 68)
train_idx : 2046024
train_idx : <class 'numpy.ndarray'>
val_idx : 769
val_idx : <class 'numpy.ndarray'>
val_idx : [   0    2    7   14   30   53   60   63   71   76   81   83  134  135
  141  155  166  188  220  221  225  234  249  252  256  263  267  272
  286  291  308  316  317  331  332  338  339  342  344  351  356  360
  386  397  398  423  433  438  440  446  482  486  493  502  508  528
  535  556  563  566  574  578  582  585  591  615  631  638  641  647
  661  668  684  693  720  731  735  740  756  759  762  764  768  800
  812  815  817  820  825  840  843  866  870  877  879  897  909  915
  934  937  944  946  947  953  975  979  982  988  989 1027 1037 1046
 1055 1066 1071 1074 1078 1080 1094 1107 1125 1144 1165 1182 1186 1192
 1195 1224 1225 1229 1231 1233 1234 1239 1248 1252 1266 1267 1281 1287
 1293 1298 1301 1303 1311 1315 1333 1340 1345 1348 1367 1370 1371 1374
 1416 1448 1460 1471 1472 1480 1503 1508 1512 1515 1563 1573 1586 1595
 1613 1624 1626 1630 1660 1663 1674 1679 1688 1695 1704 1707 1714 1716
 1719 1723 1724 1727 1761 1767 1768 1779 1782 1790 1802 1807 1809 1811
 1821 1844 1845 1849 1859 1868 1873 1877 1904 1907 1924 1926 1927 1928
 1934 1945 1946 1951 1952 1986 2013 2028 2029 2037 2040 2046 2051 2083
 2084 2107 2111 2117 2120 2124 2129 2136 2145 2146 2151 2171 2182 2198
 2204 2207 2213 2215 2222 2251 2262 2271 2278 2281 2316 2318 2334 2336
 2346 2349 2351 2359 2360 2362 2373 2380 2407 2410 2417 2430 2453 2465
 2474 2491 2520 2528 2531 2540 2543 2548 2554 2565 2570 2577 2578 2583
 2594 2608 2625 2679 2686 2689 2693 2703 2719 2720 2733 2740 2746 2757
 2766 2779 2782 2787 2792 2799 2813 2844 2846 2858 2863 2881 2884 2895
 2896 2908 2912 2918 2922 2927 2938 2953 2957 2959 2984 2988 2996 2997
 2999 3006 3008 3012 3033 3056 3091 3098 3105 3106 3109 3128 3141 3155
 3162 3164 3177 3182 3195 3224 3239 3307 3324 3327 3329 3349 3355 3359
 3360 3377 3381 3393 3401 3410 3422 3429 3437 3440 3464 3466 3493 3500
 3519 3520 3523 3537 3551 3555 3560 3565 3583 3584 3587 3596 3601 3603
 3613 3649 3658 3661 3663 3686 3704 3709 3715 3720 3742 3749 3752 3775
 3800 3803 3814 3817 3823 3833 3839 3852 3860 3878 3879 3895 3896 3900
 3912 3925 3926 3932 3933 3958 3960 3985 3996 4001 4009 4010 4041 4062
 4073 4087 4109 4118 4144 4159 4163 4190 4197 4201 4211 4213 4214 4223
 4240 4254 4264 4271 4279 4285 4294 4311 4312 4314 4316 4325 4330 4332
 4343 4349 4357 4371 4377 4378 4390 4397 4400 4408 4409 4411 4412 4438
 4453 4454 4457 4469 4473 4477 4479 4503 4510 4514 4526 4527 4528 4532
 4533 4549 4560 4567 4577 4579 4593 4603 4638 4648 4675 4676 4678 4685
 4707 4715 4752 4771 4773 4781 4797 4810 4841 4848 4861 4876 4881 4911
 4914 4920 4925 4926 4935 4940 4941 4955 4960 4966 4990 4995 5000 5003
 5007 5015 5016 5017 5018 5030 5033 5051 5060 5070 5077 5082 5103 5145
 5150 5154 5200 5207 5209 5215 5223 5226 5232 5241 5279 5286 5288 5294
 5308 5323 5343 5365 5421 5429 5441 5443 5448 5455 5462 5504 5511 5512
 5519 5539 5542 5547 5560 5570 5578 5594 5604 5613 5626 5637 5656 5677
 5679 5686 5702 5715 5719 5730 5731 5734 5743 5749 5758 5776 5777 5779
 5780 5796 5798 5799 5810 5822 5824 5834 5838 5845 5867 5868 5877 5884
 5895 5907 5920 5922 5945 5950 5957 5980 5992 6011 6016 6028 6034 6054
 6059 6080 6101 6108 6129 6130 6141 6149 6152 6163 6169 6171 6175 6179
 6181 6186 6188 6197 6231 6233 6245 6251 6271 6283 6290 6291 6298 6332
 6335 6344 6345 6347 6355 6370 6373 6412 6426 6435 6439 6446 6452 6456
 6487 6489 6492 6493 6498 6500 6505 6522 6523 6543 6545 6567 6588 6594
 6595 6603 6618 6624 6631 6651 6658 6659 6683 6691 6694 6703 6709 6717
 6726 6733 6740 6744 6771 6774 6789 6805 6809 6837 6839 6842 6843 6847
 6849 6853 6862 6865 6885 6886 6903 6907 6912 6917 6936 6947 6964 6970
 6976 6990 6997 6998 6999 7006 7014 7034 7037 7056 7071 7083 7097 7100
 7107 7108 7117 7127 7129 7130 7149 7150 7155 7161 7166 7181 7192 7195
 7200 7207 7213 7242 7245 7251 7254 7287 7288 7295 7300 7306 7324 7330
 7336 7338 7364 7375 7383 7384 7385 7398 7403 7411 7413 7428 7436]
shape of X : (2273360, 68)
train_idx : 2046024
train_idx : <class 'numpy.ndarray'>
val_idx : 720
val_idx : <class 'numpy.ndarray'>
val_idx : [  13   18   19   44   54   85   98  102  107  112  115  121  132  140
  145  146  156  168  170  187  191  193  194  202  211  248  255  264
  265  277  278  302  306  343  348  354  361  381  387  400  415  420
  427  431  444  450  455  461  472  473  491  511  512  516  529  532
  553  557  561  565  587  594  602  624  630  634  642  654  662  678
  687  708  709  726  730  734  742  761  767  781  785  790  811  832
  834  838  842  849  858  882  891  892  922  933  935  943  963  966
  990 1004 1021 1025 1029 1030 1041 1047 1051 1052 1057 1061 1069 1081
 1082 1085 1097 1105 1106 1119 1129 1135 1140 1159 1183 1184 1202 1206
 1216 1230 1240 1245 1254 1255 1264 1265 1270 1274 1275 1317 1319 1339
 1347 1353 1364 1372 1378 1382 1388 1395 1401 1415 1427 1428 1431 1438
 1442 1457 1461 1468 1486 1491 1511 1513 1522 1527 1542 1577 1578 1579
 1588 1623 1634 1641 1649 1656 1678 1683 1701 1702 1708 1710 1712 1731
 1740 1747 1797 1813 1839 1893 1900 1911 1913 1929 1933 1937 1940 1943
 1963 1971 1974 1983 1991 1998 2006 2031 2038 2044 2045 2055 2058 2060
 2065 2070 2075 2085 2087 2089 2095 2096 2098 2100 2109 2131 2132 2186
 2188 2202 2206 2210 2217 2264 2277 2284 2291 2295 2305 2313 2324 2327
 2328 2332 2340 2344 2345 2369 2375 2386 2398 2406 2412 2415 2428 2436
 2449 2463 2475 2482 2487 2489 2493 2494 2509 2524 2532 2545 2551 2563
 2568 2569 2600 2611 2616 2622 2643 2656 2660 2661 2667 2680 2681 2685
 2710 2724 2732 2760 2761 2763 2777 2780 2781 2783 2794 2802 2807 2812
 2823 2855 2872 2873 2875 2879 2901 2906 2934 2949 2955 2995 3017 3022
 3029 3037 3038 3052 3053 3058 3065 3072 3086 3102 3114 3118 3126 3130
 3133 3142 3169 3174 3179 3186 3194 3217 3235 3254 3263 3265 3289 3308
 3317 3318 3337 3343 3348 3350 3363 3369 3378 3396 3403 3407 3414 3427
 3448 3462 3477 3485 3505 3516 3517 3527 3528 3542 3559 3564 3598 3609
 3617 3619 3621 3657 3662 3665 3674 3676 3683 3692 3708 3719 3726 3729
 3732 3733 3735 3747 3759 3762 3768 3771 3787 3795 3798 3808 3844 3851
 3875 3882 3887 3902 3904 3945 3956 3963 3970 3979 3999 4006 4017 4019
 4023 4028 4034 4048 4052 4066 4088 4104 4110 4117 4130 4146 4148 4149
 4158 4176 4191 4199 4204 4216 4225 4228 4244 4246 4252 4261 4269 4289
 4298 4304 4307 4322 4335 4342 4351 4356 4381 4391 4399 4427 4429 4433
 4439 4445 4446 4471 4481 4496 4509 4545 4546 4556 4573 4601 4602 4613
 4616 4622 4630 4632 4633 4645 4650 4655 4671 4673 4688 4742 4745 4776
 4779 4808 4822 4827 4830 4836 4842 4851 4859 4882 4912 4932 4949 4993
 5008 5026 5062 5078 5092 5104 5123 5127 5136 5140 5156 5173 5179 5187
 5188 5190 5201 5211 5220 5225 5239 5247 5252 5263 5304 5311 5314 5321
 5354 5361 5392 5405 5419 5426 5428 5457 5459 5463 5466 5488 5499 5502
 5513 5525 5536 5567 5577 5580 5618 5627 5632 5647 5652 5660 5661 5711
 5718 5729 5747 5751 5761 5770 5790 5794 5806 5821 5832 5850 5851 5853
 5857 5863 5869 5873 5885 5898 5900 5905 5926 5930 5933 5940 5948 5961
 5964 5967 5969 6027 6039 6040 6055 6063 6064 6066 6068 6087 6091 6106
 6111 6114 6119 6132 6158 6172 6177 6187 6190 6209 6213 6225 6249 6254
 6260 6287 6296 6303 6309 6313 6318 6323 6333 6343 6351 6360 6386 6404
 6406 6416 6440 6463 6466 6480 6503 6510 6512 6524 6526 6535 6540 6552
 6559 6598 6606 6614 6619 6620 6622 6629 6641 6647 6653 6662 6674 6677
 6688 6690 6705 6707 6714 6755 6759 6766 6778 6785 6790 6796 6799 6816
 6826 6832 6833 6834 6881 6889 6890 6891 6893 6910 6916 6919 6924 6953
 6962 6968 6996 7007 7010 7018 7025 7035 7036 7051 7053 7054 7101 7103
 7114 7116 7131 7144 7163 7168 7178 7193 7202 7208 7209 7223 7225 7234
 7240 7261 7262 7264 7277 7314 7318 7320 7323 7331 7339 7344 7345 7346
 7390 7401 7405 7406 7422 7435]
shape of X : (2273360, 68)
train_idx : 2046024
train_idx : <class 'numpy.ndarray'>
val_idx : 764
val_idx : <class 'numpy.ndarray'>
val_idx : [  34   57   61   68   88   95  106  108  113  117  124  167  171  201
  204  223  226  230  250  262  282  300  305  307  337  340  359  377
  414  439  441  456  464  465  467  468  471  484  488  495  498  518
  519  524  531  544  549  559  568  569  573  575  581  584  590  592
  598  600  613  633  635  646  670  676  681  689  691  710  712  713
  719  729  738  739  744  747  753  758  773  777  789  796  799  852
  853  865  868  871  875  884  885  902  914  921  923  926  928  936
  949  961  972 1010 1022 1040 1042 1043 1048 1056 1089 1101 1110 1133
 1138 1139 1143 1162 1179 1188 1189 1193 1197 1250 1258 1261 1269 1283
 1302 1307 1314 1323 1328 1337 1343 1368 1396 1397 1399 1423 1445 1449
 1490 1520 1550 1556 1565 1567 1584 1600 1647 1668 1671 1691 1696 1738
 1743 1745 1751 1752 1775 1784 1789 1794 1804 1806 1812 1820 1826 1842
 1848 1851 1853 1862 1871 1879 1881 1884 1888 1889 1894 1896 1901 1902
 1908 1917 1931 1936 1944 1947 1948 1969 1973 1992 1993 2005 2011 2048
 2073 2080 2081 2094 2097 2102 2106 2110 2114 2122 2130 2165 2166 2191
 2195 2203 2205 2211 2216 2224 2234 2236 2243 2246 2287 2298 2301 2303
 2319 2325 2329 2335 2338 2350 2368 2374 2383 2384 2394 2396 2409 2411
 2423 2432 2441 2442 2450 2451 2455 2467 2490 2498 2507 2514 2515 2517
 2518 2519 2521 2522 2530 2541 2544 2547 2560 2574 2591 2599 2602 2620
 2629 2638 2649 2655 2670 2677 2683 2688 2694 2695 2702 2705 2707 2712
 2736 2748 2749 2750 2768 2773 2776 2800 2806 2815 2830 2833 2849 2852
 2854 2857 2909 2917 2920 2923 2929 2952 2954 2961 2964 2977 3002 3015
 3026 3050 3075 3077 3083 3085 3094 3124 3132 3134 3139 3146 3150 3170
 3180 3183 3187 3197 3200 3220 3226 3227 3262 3271 3274 3280 3301 3309
 3345 3361 3373 3375 3376 3387 3419 3425 3438 3456 3463 3496 3499 3503
 3521 3534 3540 3552 3554 3582 3600 3602 3611 3625 3639 3644 3646 3650
 3651 3666 3671 3681 3689 3691 3703 3723 3728 3758 3763 3772 3785 3786
 3809 3821 3824 3834 3838 3842 3856 3863 3866 3894 3899 3905 3921 3923
 3924 3928 3941 3950 3974 4039 4046 4068 4080 4112 4121 4150 4152 4167
 4183 4202 4206 4222 4227 4229 4234 4242 4245 4255 4260 4267 4284 4301
 4305 4313 4326 4334 4346 4353 4365 4380 4395 4432 4437 4442 4449 4451
 4470 4517 4530 4544 4552 4553 4555 4569 4580 4596 4600 4605 4608 4609
 4611 4619 4646 4653 4662 4680 4690 4697 4702 4705 4709 4711 4714 4728
 4737 4744 4749 4750 4755 4766 4769 4786 4802 4820 4821 4826 4852 4863
 4869 4879 4893 4903 4908 4928 4934 4937 4938 4942 4956 4961 4974 4975
 4984 4987 4996 4997 5010 5028 5037 5040 5041 5045 5046 5056 5076 5088
 5089 5091 5102 5107 5108 5118 5119 5134 5137 5144 5148 5149 5157 5166
 5181 5197 5202 5231 5233 5240 5249 5258 5260 5262 5267 5275 5277 5284
 5303 5305 5315 5317 5318 5324 5328 5338 5350 5362 5395 5403 5412 5414
 5432 5452 5461 5464 5471 5474 5475 5485 5507 5514 5518 5530 5546 5566
 5587 5608 5636 5646 5651 5657 5666 5667 5678 5683 5684 5691 5695 5697
 5705 5712 5713 5726 5728 5737 5738 5739 5741 5754 5757 5767 5788 5797
 5811 5814 5819 5820 5842 5846 5847 5859 5865 5874 5882 5886 5892 5893
 5899 5917 5921 5928 5931 5937 5951 5953 5968 5977 5982 5983 6005 6021
 6023 6025 6035 6036 6046 6052 6089 6113 6124 6134 6135 6153 6164 6167
 6178 6180 6189 6192 6194 6203 6210 6221 6224 6226 6239 6242 6259 6297
 6307 6319 6320 6349 6363 6369 6392 6399 6401 6411 6414 6423 6427 6437
 6448 6449 6476 6477 6501 6507 6515 6516 6525 6536 6560 6578 6596 6601
 6602 6611 6634 6636 6645 6656 6661 6669 6670 6687 6706 6712 6713 6719
 6734 6753 6758 6775 6780 6783 6788 6793 6801 6835 6844 6858 6859 6892
 6918 6930 6939 6948 6963 6975 6977 6992 7021 7026 7027 7028 7044 7057
 7058 7061 7062 7074 7076 7078 7106 7113 7143 7145 7158 7170 7173 7185
 7186 7187 7206 7210 7214 7217 7218 7221 7243 7248 7256 7273 7283 7286
 7301 7303 7304 7310 7340 7348 7357 7362 7363 7365 7368 7369 7377 7380
 7386 7397 7404 7418 7425 7427 7429 7439]
shape of X : (2273360, 68)
train_idx : 2046024
train_idx : <class 'numpy.ndarray'>
val_idx : 739
val_idx : <class 'numpy.ndarray'>
val_idx : [   6   10   17   32   38   62   75   93   96  103  109  120  123  131
  143  144  147  157  160  164  165  174  183  192  203  210  216  228
  238  244  247  260  266  269  271  287  289  303  304  311  318  322
  323  334  363  372  374  376  378  388  389  394  401  408  410  419
  424  474  483  485  487  496  507  517  522  527  530  534  560  571
  597  601  603  611  612  619  637  643  649  653  666  671  692  697
  705  736  741  743  760  765  780  836  851  854  857  874  880  890
  898  905  911  913  918  920  942  950  951  957  983 1005 1006 1026
 1031 1038 1054 1063 1091 1096 1102 1108 1113 1118 1130 1148 1161 1163
 1176 1203 1207 1208 1220 1226 1228 1243 1257 1277 1300 1309 1330 1346
 1357 1379 1391 1407 1418 1429 1446 1452 1456 1466 1484 1487 1488 1496
 1501 1506 1514 1538 1548 1554 1557 1560 1564 1572 1590 1601 1604 1605
 1606 1628 1643 1644 1650 1651 1653 1659 1682 1692 1705 1729 1732 1734
 1741 1754 1756 1770 1786 1805 1832 1840 1850 1869 1870 1872 1874 1875
 1882 1891 1909 1930 1960 1982 1989 2000 2022 2035 2053 2062 2074 2076
 2099 2108 2112 2115 2121 2139 2141 2148 2152 2172 2177 2181 2190 2192
 2193 2212 2214 2226 2228 2248 2253 2259 2265 2269 2302 2308 2310 2323
 2353 2358 2372 2385 2414 2420 2426 2444 2447 2452 2470 2477 2481 2484
 2512 2513 2529 2539 2550 2556 2572 2576 2582 2596 2597 2614 2624 2634
 2659 2672 2674 2708 2713 2716 2728 2731 2735 2741 2744 2753 2755 2758
 2764 2772 2778 2793 2797 2798 2805 2808 2820 2824 2831 2834 2853 2878
 2894 2898 2910 2944 2963 2970 2971 2972 2973 2982 2985 2990 2991 2992
 3018 3020 3039 3041 3059 3063 3067 3069 3099 3123 3125 3131 3136 3154
 3156 3157 3173 3203 3219 3234 3236 3242 3245 3261 3269 3277 3282 3291
 3294 3297 3310 3313 3328 3332 3335 3353 3365 3366 3371 3386 3389 3390
 3402 3409 3412 3424 3431 3432 3433 3441 3442 3459 3467 3471 3480 3481
 3486 3510 3511 3525 3548 3549 3562 3569 3570 3576 3578 3590 3612 3642
 3659 3667 3670 3675 3702 3737 3754 3755 3773 3774 3783 3792 3794 3807
 3832 3840 3843 3847 3865 3870 3886 3908 3913 3917 3953 3959 3968 3973
 3984 4027 4032 4038 4045 4053 4058 4060 4064 4069 4071 4095 4097 4102
 4111 4122 4128 4134 4141 4161 4165 4169 4175 4195 4233 4241 4247 4268
 4274 4277 4297 4300 4310 4319 4320 4328 4347 4348 4355 4368 4373 4385
 4404 4414 4418 4422 4464 4475 4487 4494 4495 4504 4508 4571 4610 4614
 4624 4627 4649 4660 4699 4700 4701 4706 4722 4724 4725 4730 4731 4732
 4735 4738 4741 4746 4754 4767 4778 4788 4792 4796 4801 4814 4816 4825
 4850 4854 4867 4868 4880 4890 4892 4904 4906 4917 4921 4930 4939 4948
 4953 4959 4986 4994 5014 5023 5025 5064 5071 5075 5080 5090 5097 5106
 5113 5114 5128 5129 5138 5141 5186 5195 5216 5248 5251 5266 5270 5272
 5289 5290 5291 5299 5310 5330 5340 5342 5346 5349 5353 5371 5377 5382
 5390 5391 5400 5409 5440 5453 5454 5470 5473 5489 5493 5508 5520 5523
 5532 5544 5557 5576 5602 5610 5619 5624 5640 5653 5698 5714 5745 5748
 5756 5765 5769 5778 5789 5792 5807 5812 5825 5826 5840 5849 5864 5866
 5881 5894 5919 5924 5934 5936 5939 5941 5943 5946 5947 5954 5960 5974
 5975 5979 5985 5988 6020 6022 6038 6073 6074 6085 6088 6094 6095 6097
 6104 6144 6145 6147 6156 6159 6193 6195 6198 6205 6229 6248 6262 6264
 6265 6269 6274 6279 6294 6304 6308 6338 6361 6365 6377 6413 6418 6430
 6441 6462 6467 6486 6497 6537 6538 6539 6541 6544 6548 6565 6566 6599
 6635 6640 6649 6657 6664 6673 6681 6686 6700 6721 6745 6747 6770 6773
 6787 6797 6802 6810 6820 6823 6825 6830 6850 6851 6852 6873 6876 6879
 6897 6899 6923 6926 6932 6933 6951 6954 6980 6984 6988 7019 7032 7055
 7066 7080 7090 7091 7093 7096 7122 7125 7133 7140 7148 7167 7176 7180
 7182 7183 7196 7197 7224 7237 7244 7258 7278 7291 7296 7297 7307 7335
 7337 7350 7351 7366 7373 7374 7387 7400 7402 7424 7432]
shape of X : (2273360, 68)
train_idx : 2046024
train_idx : <class 'numpy.ndarray'>
val_idx : 743
val_idx : <class 'numpy.ndarray'>
val_idx : [   9   45   48   49   64   65   70   90   99  101  104  119  128  149
  161  176  206  208  217  239  254  285  294  330  345  346  347  362
  379  385  402  411  432  460  466  476  478  481  521  572  589  595
  599  614  625  639  648  655  656  659  663  699  706  718  732  754
  769  772  778  792  798  801  802  803  823  828  835  844  861  867
  876  903  907  912  929  952  958  968  973  977  981  984  986  987
  992 1003 1007 1011 1013 1019 1023 1050 1064 1067 1103 1104 1122 1126
 1127 1128 1134 1136 1149 1170 1173 1196 1198 1204 1218 1232 1272 1297
 1306 1335 1349 1351 1360 1361 1362 1376 1402 1424 1426 1437 1439 1450
 1453 1458 1463 1467 1470 1476 1478 1492 1497 1498 1502 1510 1533 1547
 1581 1614 1615 1618 1620 1625 1640 1645 1652 1665 1673 1686 1700 1737
 1742 1776 1792 1796 1810 1827 1830 1834 1836 1838 1843 1865 1876 1883
 1914 1918 1919 1920 1921 1938 1949 1955 1958 1964 1968 1975 1977 1994
 1999 2001 2003 2036 2066 2068 2079 2086 2113 2116 2128 2134 2140 2144
 2147 2150 2154 2156 2161 2162 2163 2170 2173 2174 2176 2185 2219 2227
 2239 2242 2250 2263 2274 2285 2299 2306 2322 2337 2364 2376 2387 2393
 2404 2405 2427 2435 2483 2495 2504 2505 2511 2526 2527 2536 2580 2581
 2584 2587 2588 2610 2628 2631 2658 2669 2671 2675 2697 2698 2714 2715
 2717 2718 2743 2751 2762 2769 2770 2796 2801 2818 2825 2828 2841 2845
 2847 2859 2860 2862 2864 2880 2891 2897 2902 2905 2913 2916 2921 2931
 2937 2946 2960 2967 3004 3021 3023 3024 3036 3040 3046 3066 3076 3082
 3090 3103 3108 3110 3111 3144 3161 3188 3190 3198 3199 3206 3209 3240
 3258 3266 3281 3296 3303 3305 3311 3312 3314 3321 3331 3342 3352 3370
 3372 3374 3382 3405 3406 3430 3436 3446 3454 3458 3461 3465 3476 3478
 3513 3536 3561 3563 3589 3628 3630 3631 3634 3640 3641 3643 3684 3710
 3714 3716 3725 3727 3734 3736 3738 3745 3750 3756 3765 3776 3779 3781
 3784 3802 3805 3848 3854 3855 3859 3871 3890 3893 3906 3907 3915 3930
 3936 3940 3966 3980 3987 3988 3994 4002 4003 4018 4026 4029 4050 4051
 4054 4061 4072 4086 4089 4100 4103 4108 4114 4133 4153 4155 4164 4171
 4203 4217 4219 4237 4248 4251 4256 4262 4292 4299 4337 4340 4345 4359
 4362 4366 4367 4372 4379 4394 4398 4410 4415 4417 4428 4430 4444 4448
 4455 4459 4478 4489 4492 4499 4501 4506 4512 4513 4516 4519 4531 4536
 4581 4606 4623 4631 4634 4639 4644 4659 4665 4682 4693 4708 4727 4740
 4761 4770 4772 4782 4823 4828 4832 4834 4835 4864 4866 4871 4883 4894
 4896 4905 4910 4936 4943 4947 4964 4972 4980 4989 4992 5020 5024 5049
 5059 5083 5095 5099 5109 5174 5213 5214 5219 5235 5265 5278 5293 5297
 5298 5326 5331 5333 5335 5336 5352 5355 5366 5381 5383 5389 5399 5404
 5420 5433 5437 5439 5445 5487 5495 5515 5517 5550 5556 5558 5574 5581
 5584 5586 5598 5609 5620 5621 5625 5650 5659 5662 5663 5672 5688 5692
 5700 5724 5725 5736 5740 5742 5752 5774 5781 5802 5827 5829 5831 5848
 5876 5888 5891 5897 5904 5908 5927 5929 5932 5942 5944 5963 5976 5989
 5990 5991 5998 6000 6007 6012 6013 6031 6058 6062 6070 6103 6117 6122
 6123 6126 6157 6166 6235 6238 6240 6244 6253 6257 6273 6280 6285 6305
 6312 6315 6316 6334 6352 6354 6362 6367 6371 6382 6383 6384 6394 6400
 6415 6429 6431 6432 6453 6472 6485 6491 6494 6496 6508 6509 6517 6518
 6519 6520 6528 6529 6533 6554 6561 6569 6570 6576 6577 6579 6589 6626
 6628 6637 6646 6654 6666 6672 6696 6698 6701 6711 6724 6725 6730 6732
 6736 6739 6742 6748 6749 6763 6767 6768 6769 6794 6795 6800 6807 6813
 6829 6841 6857 6860 6866 6868 6871 6872 6880 6883 6884 6888 6904 6905
 6915 6925 6927 6928 6929 6952 6956 6966 6991 6993 6995 7000 7001 7003
 7015 7017 7040 7050 7065 7082 7087 7095 7099 7110 7123 7124 7134 7152
 7164 7172 7177 7198 7199 7203 7216 7239 7260 7269 7274 7290 7302 7321
 7327 7329 7342 7352 7355 7360 7371 7382 7389 7410 7414 7417 7426 7430
 7440]
shape of X : (2273360, 68)
train_idx : 2046024
train_idx : <class 'numpy.ndarray'>
val_idx : 750
val_idx : <class 'numpy.ndarray'>
val_idx : [   4   15   16   22   25   28   35   41   77   82   89   91   97  110
  114  137  142  150  152  154  172  179  182  190  212  214  241  242
  253  268  281  283  293  296  298  319  326  341  350  352  365  367
  368  373  375  383  384  390  392  406  418  449  453  462  480  500
  510  514  523  536  542  547  576  610  620  636  645  650  651  664
  677  679  682  690  695  700  701  703  707  711  716  717  746  751
  793  797  809  818  830  833  837  845  855  862  869  872  881  887
  888  895  896  900  908  938  945  985  998 1001 1008 1012 1024 1053
 1058 1059 1062 1087 1111 1120 1121 1142 1146 1153 1180 1190 1200 1201
 1209 1214 1219 1246 1249 1253 1259 1262 1276 1294 1299 1308 1313 1316
 1324 1336 1338 1375 1386 1392 1398 1405 1410 1412 1417 1432 1436 1440
 1444 1447 1465 1475 1493 1494 1509 1517 1519 1521 1523 1528 1532 1540
 1543 1546 1555 1576 1587 1591 1596 1609 1622 1632 1635 1639 1642 1646
 1655 1689 1694 1717 1725 1728 1730 1769 1772 1791 1795 1798 1799 1800
 1801 1818 1824 1828 1854 1861 1880 1915 1916 1932 1953 1961 1962 1965
 1970 1978 1981 2021 2032 2033 2039 2043 2049 2054 2063 2064 2088 2104
 2105 2118 2127 2133 2143 2149 2153 2155 2159 2178 2179 2180 2197 2231
 2240 2254 2270 2273 2288 2293 2300 2314 2317 2333 2367 2377 2379 2388
 2397 2418 2422 2424 2448 2456 2459 2468 2473 2476 2486 2497 2506 2525
 2535 2537 2538 2552 2553 2557 2562 2579 2603 2618 2621 2627 2639 2642
 2644 2645 2663 2666 2668 2678 2682 2706 2738 2786 2817 2821 2822 2826
 2832 2842 2848 2865 2866 2868 2887 2900 2904 2932 2951 2989 3005 3010
show more (open the raw output data in a text editor) ...

 6824 6831 6855 6863 6887 6896 6901 6902 6911 6920 6941 6949 6961 6969
 7004 7005 7039 7042 7045 7047 7048 7070 7072 7075 7081 7086 7111 7120
 7184 7188 7189 7191 7211 7212 7215 7222 7230 7265 7270 7272 7280 7282
 7293 7309 7322 7333 7334 7353 7379 7399 7408 7409 7420]
shape of X : (2273360, 68)
```



## 3)

Input

```python
class LastSolveKFold:
    def __init__(self,
                n_splits=10,
                shuffle=True,
                random_state=42
                ):
        self.n_splits = n_splits
        self.shuffle = shuffle
        self.random_state = random_state

    def split(self, X, y=None, groups=None):
        # print(X.head())
        print(X['userID'])
        user_id = np.array(X['userID'])
        X, y, groups = [np.array(iterable) for iterable in (X, y, groups)]
        n_samples = len(X)
        #########################################
        last_user_index = np.where(np.roll(user_id, shift=-1) != user_id)[0]
        total_val_indices = []
        total_indices = np.arange(n_samples)
        print(f"last_user_index : {len(last_user_index)}")
        print(f"total_indices : {len(total_indices)}")
        print(f"len(total_indices)-len(last_user_index)//10 : {len(total_indices)-len(last_user_index)//10}")
        for _, test_idx in tqdm(KFold(n_splits=self.n_splits, shuffle=self.shuffle, random_state = self.random_state).split(last_user_index)):
            test_idx = last_user_index[test_idx]
            total_val_indices.extend(test_idx)
            train_idx = [tr_id for tr_id in total_indices if not tr_id in test_idx]
            print(f'train_idx : {len(train_idx)}')
            print(f'train_idx : {type(train_idx)}')
            print(f'val_idx : {len(test_idx)}')
            print(f'val_idx : {type(test_idx)}')
            print(f'val_idx : {test_idx}')
            print(f'shape of X : {X.shape}')
            yield np.array(train_idx), np.array(test_idx)
        print(f"valid Set이 된 모든 row들의 개수 : {len(total_val_indices)}")
        print(f"valid Set이 된 모든 row들 unique 개수 : {len(set(total_val_indices))}")

    def get_n_splits(self, X, y=None, groups=None):
        return self.n_splits

last_fold = LastSolveKFold(n_splits=10, shuffle=True, random_state=42)
```

Output

```bash
0          3503.0
1           760.0
2          3484.0
3           259.0
4          4911.0
            ...  
2273355    2402.0
2273356    6480.0
2273357     891.0
2273358     581.0
2273359    3630.0
Name: userID, Length: 2273360, dtype: float32

0it [00:00, ?it/s]last_user_index : 2272748
total_indices : 2273360
len(total_indices)-len(last_user_index)//10 : 2046086

1it [04:23, 263.94s/it]train_idx : 2046085
train_idx : <class 'list'>
val_idx : 227275
val_idx : <class 'numpy.ndarray'>
val_idx : [     0      1      2 ... 227334 227335 227336]
shape of X : (2273360, 69)
```

> userid를 KFold에 input으로서 들어가는 데이터 X에서 뽑아내고, 코드가 진행되도록 하였다.
>
> **에러 문제가 해결되었다!!** 하지만, 현재 user id가 shuffle 되어있는 문제가 있다
>
> user_id가 shuffle되면 user별 맨마지막 row의 index를 제대로 가져오질 못하는 문제가 발생한다.
>
> - pycaret의 setup에서 *data_split_shuffle* = False로 설정해보도록 한다. # True가 default
> - 시간도 오래걸림.. list comprehension을 numpy의 집합 연산 method로 바꿈



## 4) 모든 이슈 해결완료~!!

Input

```python
# class LastSolveKFold(KFold):
class LastSolveKFold:
    def __init__(self,
                n_splits=10,
                shuffle=True,
                random_state=42
                ):
        self.n_splits = n_splits
        self.shuffle = shuffle
        self.random_state = random_state

    def split(self, X, y=None, groups=None):
        # print(X.head())
        print(X['userID'])
        user_id = np.array(X['userID'])
        X, y, groups = [np.array(iterable) for iterable in (X, y, groups)]
        n_samples = len(X)
        #########################################
        last_user_index = np.where(np.roll(user_id, shift=-1) != user_id)[0]
        total_val_indices = []
        total_indices = np.arange(n_samples)
        print(f"last_user_index : {len(last_user_index)}")
        print(f"total_indices : {len(total_indices)}")
        print(f"len(total_indices)-len(last_user_index)//10 : {len(total_indices)-len(last_user_index)//10}")
        for _, test_idx in tqdm(KFold(n_splits=self.n_splits, shuffle=self.shuffle, random_state = self.random_state).split(last_user_index)):
            test_idx = last_user_index[test_idx]
            total_val_indices.extend(test_idx)
            # train_idx = [tr_id for tr_id in total_indices if not tr_id in test_idx]
            train_idx = np.setdiff1d(total_indices, test_idx)
            print(f'train_idx : {len(train_idx)}')
            print(f'train_idx : {type(train_idx)}')
            print(f'val_idx : {len(test_idx)}')
            print(f'val_idx : {type(test_idx)}')
            print(f'val_idx : {test_idx}')
            print(f'shape of X : {X.shape}')
            yield np.array(train_idx), np.array(test_idx)
        print(f"valid Set이 된 모든 row들의 개수 : {len(total_val_indices)}")
        print(f"valid Set이 된 모든 row들 unique 개수 : {len(set(total_val_indices))}")

    def get_n_splits(self, X, y=None, groups=None):
        return self.n_splits

last_fold = LastSolveKFold(n_splits=10, shuffle=True, random_state=42)

```

Output

```bash
0             0.0
1             0.0
2             0.0
3             0.0
4             0.0
            ...  
2273355    4382.0
2273356    4382.0
2273357    4382.0
2273358    4382.0
2273359    4382.0
Name: userID, Length: 2273360, dtype: float32

2it [00:00, 13.52it/s]last_user_index : 4383
total_indices : 2273360
len(total_indices)-len(last_user_index)//10 : 2272922
train_idx : 2272921
train_idx : <class 'numpy.ndarray'>
val_idx : 439
val_idx : <class 'numpy.ndarray'>
val_idx : [   744   1677   1953   2988   3658   4491   5412   6224   6760   7627
   7997   8602   9541  10857  11519  12737  14015  15274  16057  17001
  17719  18858  19464  21019  21988  23140  23526  24994  26036  26889
  27816  28506  29439  30387  31554  32245  32781  33375  33742  34670
  35580  36630  37152  37881  38797  39880  40786  41416  42304  43510
  44830  46492  46928  47620  49325  50042  50879  51108  51918  52589
  53699  54931  55123  56073  57342  58186  58687  59845  60515  60990
  61850  62621  63005  63374  63986  65557  65966  66822  68047  69116
  70332  71331  72482  73304  74570  75493  76148  77378  78920  79632
  79866  80256  81229  82797  84088  85113  86266  87048  87854  88681
  89627  89861  91016  91728  92358  93006  94121  94756  95510  96862
  97993  98480  99450 101046 101735 102053 102647 104145 105352 106583
 107116 107334 108368 108706 109144 109865 110399 111312 111994 112858
 113299 114330 115370 116131 116824 117690 118834 119232 119585 120183
 120807 121592 121979 122486 123826 125011 125576 126613 127279 128104
 128992 129603 130893 131357 132178 132686 133521 134336 135816 136753
 137544 138784 139639 140227 141140 142222 142669 143401 144464 145961
 146530 147482 148114 148514 150039 150501 151692 152240 152790 153006
 153848 154592 155095 155647 156611 157111 158748 159416 159861 160835
 161420 161833 162933 163199 163640 164179 164785 165837 166302 167182
 168065 168798 169817 171134 172074 172729 173602 174521 175350 175835
 176754 177475 177939 178540 179325 180651 181283 182328 183210 183683
 184624 185734 186286 186973 188112 188650 188865 189226 189560 190459
 191259 192065 193134 193812 194866 195721 195983 196499 197187 197922
 198310 198937 199645 200855 201343 202155 202881 203923 204719 205423
 205995 206762 208179 208628 209613 211330 211964 212681 213201 214118
 215452 216228 216992 217859 218545 219319 220327 221184 222187 222904
 223114 224482 225014 225452 226177 226796 228109 228975 229666 230825
 231049 231293 232046 232262 232531 233093 234033 234905 236432 237204
 238310 239157 239988 241009 241786 242489 243358 243879 245018 245618
 246088 246582 247231 247726 248740 249385 250398 251326 252268 252808
 253967 255040 255553 256389 257365 257944 258873 259290 259883 260911
 261357 262483 263805 264543 265620 266420 266862 267584 267997 268501
 269696 270247 271412 271801 272963 273322 274069 275055 275809 276314
 277186 278045 278415 279362 279799 280390 280986 282100 282660 283931
 285032 285796 286698 287398 288571 289140 290272 290730 291325 292277
 293239 293738 294234 295249 296211 296724 297409 298018 298833 299084
 300289 301461 303048 304451 305448 306685 307378 308273 308802 309139
 310228 310939 311597 312220 313059 313499 313968 315113 315767 316235
 317466 318325 319098 320067 321841 322251 322534 323338 324736 325347
 325931 326510 327494 328900 330385 331114 331782 332439 333916 335046
 336206 337294 338306 338917 339698 340224 340575 341888 343011 343807
 345059 345770 346578 347450 348352 348741 349658 350212 350806 352391
 352969 353947 354177 355515 356287 356855 358159 358746 359428]
shape of X : (2273360, 69)
train_idx : 2272921
train_idx : <class 'numpy.ndarray'>
val_idx : 439
val_idx : <class 'numpy.ndarray'>
val_idx : [360049 360735 361281 362036 362808 363460 363801 364123 365047 365814
 366633 367939 368806 369491 370079 371038 372530 373808 374844 375628
 376443 377039 377588 378384 378886 379580 380072 381645 382320 382587
 383345 383978 384823 385211 386184 386844 387565 388117 388967 389731
 390401 390793 392640 393138 393766 394563 395172 396219 397247 398542
 399036 399973 400160 400733 401099 401892 402714 403463 404506 405144
 405687 406550 407094 407725 408116 408998 409699 410204 410973 411525
 412118 412832 413519 413760 414940 415531 416361 417101 418220 418555
 419184 420041 420521 420996 421760 422582 423419 424416 424988 425893
 426195 427018 427775 428826 430083 430848 431656 432408 432806 433883
 434557 435052 435602 436519 437779 438119 438699 439414 440427 441103
 441819 442266 442801 443679 444244 444664 445919 446977 447462 448111
 448516 449292 449646 450659 450880 451300 451892 452548 453182 454000
 454736 455252 456509 456834 457436 458287 458785 459445 460083 460976
 461753 462659 463382 464173 464826 466445 468002 468512 469120 469749
 471417 471852 473079 474329 475122 475648 476442 476721 477538 478619
 480077 481029 482314 482923 483432 484292 484692 485933 486382 487343
 488194 489011 489821 490638 491456 491681 492013 492902 494234 495586
 497145 498304 498539 499969 501540 502609 502816 503594 504301 504888
 505339 505547 506266 507304 508737 509086 510061 510613 511392 511974
 512466 513446 514135 514640 515250 515760 516220 516471 516921 517849
 518562 519757 520481 521091 521893 522304 523363 523839 524431 525349
 526152 526884 527568 528670 529380 529475 529908 530500 530930 531296
 531575 532123 533348 533980 535187 536328 536969 537745 539042 539902
 540973 541500 542186 542968 543946 544579 545455 546393 546567 547409
 548012 548693 549802 550260 551225 552079 552339 553004 553877 554610
 555172 555710 556419 557040 557479 558827 559479 560039 560658 561246
 562305 563116 563710 564240 565047 565492 565956 567086 567688 568864
 569415 570469 571711 572917 573922 574877 575135 576356 577174 577876
 579139 580999 581281 581759 582750 583187 584345 585188 586016 586506
 586868 587744 588672 589066 589869 591156 591660 592435 593099 593976
 594795 595841 596655 597384 598015 598672 599208 599810 600164 601194
 601468 602379 602617 603397 604143 604681 605428 605786 606581 607160
 608309 608655 609927 610275 610626 610874 611496 612050 613327 614136
 615341 616154 617059 617669 618488 619750 619972 620783 621383 622454
 623624 624890 625888 626504 627411 628166 628929 629520 629903 630386
 630581 631850 632434 633658 634670 635674 636913 637513 638444 639056
 639221 639673 640277 641552 642478 643642 644104 645668 646317 647267
 647645 649142 649414 650484 651272 651939 652970 653446 653909 654772
 655865 656405 656666 657491 657912 658594 659114 659365 660221 660510
 661600 662725 663176 664122 664988 665289 666521 666881 667181 667893
 669624 670194 671005 671639 672012 672411 673438 673898 674375 675383
 676008 676558 677561 678098 678643 679050 679864 680402 680907 681577
 682608 682845 683801 684223 684686 685734 686114 686844 687516]
shape of X : (2273360, 69)
train_idx : 2272921
train_idx : <class 'numpy.ndarray'>
val_idx : 439
val_idx : <class 'numpy.ndarray'>
val_idx : [688649 689525 690110 690696 692011 692721 693355 693882 695211 695392
 695769 696031 696805 697840 698884 699916 700894 701278 702058 702942
 703251 703515 704237 705829 706506 707376 707932 708213 708433 709117
 709766 710747 711182 712265 712485 713423 714684 715274 715988 716725
 717204 718066 718784 719760 720069 720788 721473 722499 724272 725287
 725636 726650 727287 727901 728716 729250 730988 731517 732359 732905
 733411 733818 734707 735515 736244 736703 737389 738338 738522 739477
 740476 740939 742399 742806 743329 744028 745140 745646 746684 747397
 748517 748961 749899 750694 751138 752216 752620 753464 754159 755053
 755659 756074 756600 756976 757824 758214 759055 760010 760713 760954
 761331 761581 761866 762507 763350 764349 764784 765210 765832 766326
 766933 767648 768667 769430 770097 770601 771253 771708 772609 773224
 773629 774580 775119 776120 776916 777471 778456 779265 779731 780378
 780707 781043 781447 782291 782776 783686 784447 785334 786470 787079
 787675 787981 789012 790158 791037 791635 792468 793169 793950 794840
 795437 796341 796655 797316 797860 798277 799036 799985 800828 802054
 802838 803678 804094 804590 805258 805914 806397 806812 807367 808227
 808967 809376 809798 810822 812176 812870 813869 814538 815029 815690
 816377 817575 818039 819135 819847 821188 821860 822475 823840 824304
 824707 825650 826149 826782 827263 827615 828444 829163 829714 830504
 831346 832382 833113 833790 834736 835339 836040 836664 837144 837823
 838745 839360 840446 841106 841209 841852 842388 842932 843809 844737
 845172 845885 846987 848197 849323 849555 850281 850710 851430 851565
 852030 852463 853074 854059 855836 856545 857487 857985 859091 859552
 859818 860545 861383 862344 862702 863612 864504 864879 866182 866928
 867947 868303 869129 870022 870436 871097 871772 872407 872738 873393
 874420 874882 875315 875690 876787 877373 877859 878616 879528 880140
 880709 881568 881789 882304 883546 884236 885097 885522 886581 887374
 887866 888225 888645 889206 889398 889770 891114 891909 892376 892848
 893398 894303 894701 894924 895923 896280 897133 898073 898767 899442
 899938 900429 901186 902052 902420 903657 904514 904831 905381 905990
 906605 907501 908503 909235 910007 910957 912442 913413 914089 914603
 915245 915786 916777 917670 918064 919395 920095 920431 921288 922059
 922588 922850 923685 924331 924586 925156 925920 926423 927183 927821
 928223 928822 929810 930360 930789 931643 931961 932446 933270 933802
 934652 935367 936171 936376 937277 938043 939018 939969 940997 941817
 942849 943292 943957 944765 945375 945989 946677 947837 948275 949006
 949650 950493 951068 951843 952756 953435 954704 955294 955979 956642
 957177 957821 958905 959049 959760 960733 961086 961660 962085 962777
 963112 963872 964424 964792 965222 966439 966742 967542 968214 968705
 969775 970157 971006 971822 972789 973446 974601 974958 975388 975968
 976503 977007 977690 978186 979330 980635 981755 982034 982405 982945
 983196 983530 984109 984874 985041 985774 986362 986857 987747 988290
 989378 989990 991007 991502 992168 992514 993172 993933 994707]
shape of X : (2273360, 69)
train_idx : 2272922
train_idx : <class 'numpy.ndarray'>
val_idx : 438
val_idx : <class 'numpy.ndarray'>
val_idx : [ 995200  995994  996610  997140  998299  999291 1000345 1000993 1001645
 1002728 1003492 1003960 1004911 1005284 1005824 1006594 1006895 1007577
 1008043 1009155 1009958 1010800 1011213 1011801 1012566 1013055 1013533
 1014682 1015475 1015949 1016465 1017843 1018650 1018753 1019213 1020042
 1020393 1020938 1021652 1021978 1022408 1023145 1023666 1024572 1025525
 1026162 1026487 1027533 1028062 1028824 1029874 1030596 1031029 1031306
 1032421 1033210 1033747 1034267 1034570 1035228 1035999 1036924 1037829
 1038628 1038973 1040532 1040980 1041852 1042666 1043387 1043779 1043940
 1044549 1045487 1046172 1046570 1047130 1048148 1048718 1049967 1050391
 1050594 1051619 1052629 1053421 1054119 1054548 1054923 1056026 1056762
 1057197 1058238 1058673 1059169 1059498 1059825 1060136 1061180 1061735
 1061893 1062498 1062942 1063286 1063725 1064300 1065028 1065760 1066440
 1067266 1067587 1068025 1068504 1069015 1069674 1070129 1070590 1071339
 1071478 1071835 1072623 1073293 1073903 1074379 1074957 1075295 1076044
 1076612 1077204 1077690 1079358 1079660 1080473 1080773 1081694 1082105
 1082416 1083200 1083758 1084031 1084662 1085409 1085853 1086701 1087268
 1087904 1088530 1089502 1090308 1090829 1091398 1092247 1092688 1093550
 1094373 1094919 1095674 1096784 1097488 1098576 1099001 1100303 1100728
 1102360 1102685 1103653 1104044 1104584 1105928 1106426 1106944 1107457
 1108202 1108600 1109795 1110473 1111373 1111971 1112318 1113245 1113389
 1114164 1114879 1115438 1116549 1116665 1116960 1117732 1118197 1118993
 1120011 1120688 1121155 1121607 1122256 1122886 1123614 1124194 1125225
 1125928 1126902 1127803 1128553 1129215 1129700 1130111 1130667 1131015
 1131994 1132966 1133408 1133726 1134459 1134755 1135640 1136496 1136846
 1137562 1138627 1139346 1139643 1139852 1140404 1141178 1142326 1142930
 1143296 1143882 1144916 1145320 1146169 1146741 1147453 1147899 1148497
 1149022 1149329 1149938 1150397 1151304 1152037 1152492 1152911 1153355
 1153642 1154135 1154457 1155743 1156199 1156489 1157047 1157577 1157917
 1158542 1159125 1160118 1160885 1161632 1162782 1163602 1164556 1165212
 1165982 1166386 1167324 1167568 1168265 1168487 1168893 1169106 1169800
 1170496 1171108 1171312 1172028 1172612 1173092 1173712 1174636 1175046
 1175579 1175787 1176791 1177224 1178961 1179515 1179754 1180377 1180982
 1181185 1181917 1182732 1183289 1183843 1184914 1185391 1185956 1186350
 1186888 1187591 1188034 1188443 1188932 1189333 1190169 1191210 1191626
 1192575 1192794 1193380 1194053 1194320 1195060 1196056 1197159 1197641
 1198283 1198415 1198700 1199213 1199685 1199939 1200406 1201388 1201952
 1202768 1203430 1204027 1204704 1205860 1206569 1206913 1207653 1208458
 1208599 1208857 1209335 1210357 1211357 1211797 1212298 1212768 1213887
 1214106 1214494 1214859 1215441 1215851 1216534 1217044 1217974 1218438
 1218661 1219172 1219683 1220460 1220708 1220993 1221500 1221932 1222703
 1223192 1223745 1224296 1224555 1225203 1225772 1226314 1227332 1228002
 1228264 1228959 1229620 1230301 1230596 1231028 1231464 1231777 1232606
 1232990 1233303 1233934 1234517 1234806 1235143 1235611 1236026 1236879
 1237175 1238130 1238604 1239574 1240038 1240604 1241347 1241867 1242111
 1242445 1243030 1243442 1244175 1244759 1244928 1245457 1246403 1246734
 1247322 1248120 1249074 1249596 1250007 1250626 1251466 1252125 1252684
 1252975 1253561 1253938 1254424 1255066 1255331 1255762 1255880 1256810
 1257285 1258105 1258420 1259482 1260220 1260902 1261616 1262031 1263475
 1264063 1265290 1265724 1266121 1267183 1267833]
shape of X : (2273360, 69)

7it [00:01,  4.58it/s]train_idx : 2272922
train_idx : <class 'numpy.ndarray'>
val_idx : 438
val_idx : <class 'numpy.ndarray'>
val_idx : [1268724 1269314 1269774 1270100 1270584 1271556 1272031 1272609 1273398
 1273971 1274115 1275016 1275879 1276182 1276715 1277440 1278148 1279385
 1279675 1280271 1281108 1281691 1282218 1282969 1283353 1284105 1284867
 1284951 1285920 1286454 1287335 1287782 1288511 1289689 1290372 1290653
 1291520 1291797 1292196 1293159 1293440 1294152 1294498 1295000 1295579
 1296136 1297213 1297970 1298360 1298651 1299370 1300240 1300710 1301857
 1302463 1303086 1303412 1304274 1304753 1305479 1306130 1307226 1307755
 1308234 1308724 1309442 1310230 1311199 1311982 1312081 1312756 1313385
 1313659 1314416 1315250 1316547 1317549 1317894 1318252 1318834 1319309
 1320112 1320716 1321063 1321354 1321475 1322289 1323112 1323805 1324467
 1324754 1325253 1325565 1326264 1326580 1326959 1327474 1328386 1328940
 1329353 1330063 1330499 1330886 1331577 1331942 1333006 1333609 1334106
 1334314 1335458 1335801 1335947 1336203 1337267 1338082 1338557 1338738
 1340144 1341052 1341534 1341722 1342236 1342869 1343368 1343856 1344302
 1344522 1344931 1345087 1345528 1346137 1346741 1347393 1347867 1348095
 1348716 1349369 1349651 1350482 1350984 1351239 1352189 1352419 1353266
 1354141 1354456 1354835 1355654 1356068 1356560 1357165 1357634 1358638
 1359098 1359438 1359846 1360279 1361311 1362209 1363189 1363405 1363866
 1364281 1365167 1365622 1366078 1366788 1367349 1367701 1368376 1368434
 1369039 1369452 1369807 1370158 1370950 1371780 1372092 1372608 1373562
 1374296 1374819 1375398 1376026 1376387 1376798 1377214 1377432 1377626
 1378241 1379061 1379298 1379536 1380089 1381054 1381821 1382414 1382628
 1383143 1383616 1384157 1384752 1385343 1386091 1386505 1386795 1387472
 1388031 1388391 1388506 1389116 1389824 1391142 1391465 1392124 1392784
 1393743 1393921 1394616 1395085 1395254 1395632 1395982 1397425 1397789
 1398157 1398622 1398938 1399149 1399441 1399802 1400192 1400759 1401168
 1401559 1402602 1403210 1403781 1404247 1404776 1405018 1405439 1406379
 1406665 1407176 1407499 1408163 1408586 1409346 1409981 1411001 1411527
 1412332 1412731 1412974 1413749 1414374 1414960 1415399 1415623 1416132
 1416680 1416824 1417387 1418216 1418654 1418825 1419696 1420731 1420981
 1421400 1422052 1422553 1422801 1423194 1423485 1424249 1424480 1425088
 1425591 1426483 1426861 1427539 1428011 1428319 1428673 1428820 1429208
 1429544 1430038 1430312 1431041 1431462 1431752 1432559 1433127 1433556
 1434100 1434966 1435092 1435630 1436109 1436292 1436850 1437326 1437733
 1438457 1438997 1439265 1439958 1440185 1440372 1440752 1441939 1442361
 1442854 1443382 1444049 1444828 1445804 1446808 1447471 1448553 1449445
 1449987 1450841 1451300 1451954 1452699 1453091 1453417 1453781 1454128
 1454666 1455099 1455501 1456558 1456985 1457099 1457639 1458473 1459185
 1459656 1460060 1460485 1460733 1461250 1461686 1462084 1462640 1463198
 1463541 1464135 1464915 1465456 1466167 1466906 1467393 1468134 1468766
 1469170 1469853 1470309 1470798 1471381 1472194 1472978 1473334 1473867
 1474156 1474577 1475288 1475582 1475986 1476507 1477118 1477299 1477826
 1478234 1478472 1479249 1480099 1480325 1481487 1481881 1482437 1482708
 1483225 1483782 1484501 1485282 1485676 1486375 1486529 1486764 1487237
 1487615 1488125 1488986 1489787 1490152 1490449 1490756 1491147 1491449
 1491867 1492306 1492829 1493891 1494520 1494780 1495542 1495890 1496559
 1497320 1497764 1498389 1499186 1499675 1500267 1500809 1501181 1502001
 1503023 1503428 1503851 1504405 1505108 1505488 1506069 1506776 1507174
 1507522 1507935 1508678 1508994 1509879 1510573]
shape of X : (2273360, 69)
train_idx : 2272922
train_idx : <class 'numpy.ndarray'>
val_idx : 438
val_idx : <class 'numpy.ndarray'>
val_idx : [1511260 1511739 1512240 1512633 1513295 1513608 1513866 1514407 1514944
 1515157 1515476 1516099 1516395 1517124 1517799 1518404 1518799 1519103
 1519460 1519925 1520251 1520933 1521341 1521708 1522536 1522689 1523171
 1523876 1524820 1525480 1526137 1526778 1527290 1528133 1528521 1529391
 1530093 1530347 1530808 1531148 1531827 1532375 1532873 1533811 1534222
 1534464 1535056 1535248 1536309 1537458 1538133 1538481 1538994 1539383
 1539803 1540531 1541077 1541379 1542056 1543055 1543475 1544082 1544288
 1544838 1545357 1545601 1545953 1546299 1546634 1546914 1547339 1547692
 1548159 1548458 1549140 1549859 1550268 1550930 1551304 1551818 1552263
 1553119 1553566 1554084 1554606 1555305 1555716 1556024 1556348 1556574
 1556891 1557369 1558121 1558734 1559089 1559739 1560319 1560949 1561179
 1561566 1561956 1562407 1562992 1563715 1564406 1564650 1565205 1565423
 1566051 1566525 1566805 1567257 1567826 1568884 1569458 1569931 1570497
 1570860 1571302 1571967 1572613 1573017 1573224 1573668 1574035 1574896
 1575294 1575893 1576040 1576394 1576736 1577016 1577338 1577524 1578116
 1578759 1579564 1580015 1580621 1581092 1581533 1582188 1582968 1583703
 1584555 1585049 1585720 1586295 1587174 1587951 1588299 1588846 1589545
 1589877 1590146 1590558 1591201 1591698 1591801 1592595 1593283 1593637
 1593970 1594481 1595149 1595344 1595911 1596302 1597078 1598055 1598260
 1598522 1598637 1599029 1599234 1599790 1600330 1600824 1601324 1601756
 1602113 1602587 1603368 1603957 1604448 1604746 1605031 1605965 1606605
 1607107 1607448 1608035 1608462 1608788 1609618 1609915 1610225 1610983
 1611726 1612195 1612493 1612729 1613219 1614499 1615079 1615266 1615834
 1616339 1616888 1617512 1618091 1618510 1618696 1619359 1619997 1620999
 1621447 1622273 1622627 1623262 1623701 1623934 1624354 1624628 1624886
 1625324 1625952 1626438 1626918 1627214 1628154 1628432 1628957 1629370
 1630291 1630937 1631382 1631653 1632224 1632685 1633030 1633840 1634062
 1634662 1634812 1634864 1635477 1636464 1636759 1637539 1637731 1638586
 1639230 1639601 1640000 1640608 1640955 1641437 1642331 1642916 1643166
 1643759 1644010 1644186 1644464 1644665 1645173 1645410 1645720 1645924
 1646378 1646627 1646869 1647588 1648000 1648668 1648978 1649304 1649916
 1650789 1651190 1651553 1651871 1652581 1653203 1653711 1654222 1655187
 1655771 1655908 1656743 1657746 1658304 1658815 1659125 1659521 1660225
 1660637 1660895 1661341 1662154 1662621 1662973 1663121 1663660 1664011
 1664502 1665076 1665487 1665711 1666299 1666714 1667395 1667801 1668169
 1668525 1668850 1669230 1669673 1670008 1670205 1670604 1671136 1671844
 1672346 1672761 1673056 1673650 1674046 1674237 1674681 1675062 1675863
 1676098 1676308 1676651 1677107 1677895 1678290 1678848 1679248 1680062
 1680700 1680957 1681307 1681439 1682027 1682780 1683115 1683844 1684355
 1685086 1685293 1685635 1686227 1686984 1687276 1687571 1688095 1688635
 1689027 1689554 1689942 1690285 1690644 1691887 1692847 1693348 1693653
 1694185 1694495 1694687 1695133 1695385 1695818 1696000 1696798 1697204
 1697539 1698165 1698781 1699010 1699640 1699728 1700445 1700843 1701228
 1701878 1702261 1702804 1703240 1703813 1704188 1704692 1704816 1705046
 1705078 1705464 1705840 1705946 1706224 1706613 1707474 1708011 1708418
 1708778 1708932 1709506 1709962 1710234 1710548 1710921 1711296 1711416
 1711866 1712300 1712464 1712997 1713337 1713582 1713889 1714084 1714869
 1715283 1715632 1716436 1716779 1717039 1717738 1718420 1718714 1719094
 1719404 1720051 1720386 1720803 1721216 1721446]
shape of X : (2273360, 69)
train_idx : 2272922
train_idx : <class 'numpy.ndarray'>
val_idx : 438
val_idx : <class 'numpy.ndarray'>
val_idx : [1721693 1721973 1722269 1722680 1723220 1723583 1724233 1724904 1725085
 1725402 1726094 1726380 1726860 1727333 1727908 1728214 1728654 1729159
 1729350 1729927 1730028 1730267 1730845 1731558 1731953 1732896 1733432
 1734160 1734593 1735457 1736011 1736314 1736936 1737241 1738182 1738501
 1739210 1739405 1739590 1740038 1740451 1741048 1741480 1741710 1741921
 1742374 1742716 1743417 1743747 1744029 1744168 1744697 1745106 1745340
 1746047 1746715 1747230 1747702 1747960 1748332 1748764 1749133 1749545
 1749891 1750090 1750363 1750680 1751756 1752255 1752839 1753137 1754102
 1754320 1754769 1755526 1756185 1756559 1757230 1757832 1758252 1758548
 1759265 1759885 1760267 1761099 1761342 1761838 1762460 1763031 1763415
 1764021 1764570 1764892 1765677 1765864 1766250 1766576 1766804 1767476
 1767911 1768762 1769219 1769864 1770249 1770853 1771348 1772091 1772321
 1772606 1772944 1773262 1773607 1773774 1774050 1774424 1775092 1775519
 1776158 1776814 1777613 1777748 1778106 1778996 1779330 1779556 1779922
 1780347 1780981 1781594 1781887 1782013 1782558 1782924 1783348 1783665
 1784004 1784299 1784723 1785010 1785395 1785618 1786421 1786922 1787162
 1787277 1787686 1788045 1788259 1788800 1789073 1789456 1789892 1790241
 1790332 1790824 1791165 1791530 1791941 1792211 1792683 1793599 1794120
 1794436 1794694 1794921 1795296 1796277 1796949 1797445 1797614 1797910
 1799160 1799738 1800373 1800468 1800644 1801360 1801631 1801866 1802122
 1802479 1803044 1803564 1803783 1804181 1804926 1805462 1806142 1806614
 1806845 1807047 1807561 1808112 1808528 1808978 1809453 1810055 1810597
 1810994 1811587 1811895 1812227 1812489 1812691 1813241 1813426 1813898
 1814427 1814880 1815274 1816104 1816503 1817267 1817474 1818078 1818504
 1819175 1819933 1820444 1820684 1820888 1821087 1821854 1822027 1822238
 1822421 1822776 1823108 1823324 1823779 1824077 1824314 1824522 1824996
 1825529 1826265 1826699 1827486 1827661 1828081 1828262 1828519 1829088
 1829561 1829767 1829843 1830220 1830440 1830877 1831071 1831711 1832164
 1832539 1833058 1833478 1833987 1834152 1834511 1834725 1835113 1835347
 1835712 1836259 1836465 1836559 1837281 1837633 1837830 1838003 1838621
 1839174 1839480 1839998 1840179 1840499 1841205 1841947 1842377 1843122
 1843785 1844254 1844743 1845179 1845729 1846051 1846194 1846889 1847377
 1847695 1848288 1848813 1848999 1849090 1849912 1850051 1850498 1850747
 1850945 1851508 1851698 1852127 1852584 1853076 1853752 1854317 1854608
 1854913 1855209 1855440 1856050 1856468 1856716 1856937 1857462 1857786
 1858150 1858505 1858891 1859285 1859919 1860438 1860862 1861404 1861962
 1862147 1862401 1862687 1862980 1863300 1863730 1864144 1864404 1864800
 1865165 1865383 1865591 1865913 1866594 1867103 1867583 1867896 1868365
 1868775 1869279 1869877 1870220 1870410 1870866 1871534 1871877 1872294
 1872642 1872911 1873888 1874504 1874817 1875009 1875644 1876065 1876806
 1877314 1878159 1878641 1878981 1879396 1879960 1880492 1880877 1881138
 1881422 1881765 1881953 1882581 1883016 1883597 1884331 1884552 1884739
 1885181 1885614 1885903 1886286 1886879 1887307 1887621 1887947 1888066
 1888506 1888896 1889441 1889983 1890799 1891256 1891437 1891663 1891796
 1891982 1892185 1892925 1893603 1893873 1894118 1894381 1894828 1895038
 1895452 1895702 1896121 1896351 1896503 1896705 1897057 1897542 1897807
 1898225 1898752 1898953 1899235 1900105 1900968 1901389 1901696 1902387
 1902669 1903480 1903852 1904105 1904594 1905009 1905230 1905366 1905921
 1906846 1907010 1907422 1907756 1908088 1908426]
shape of X : (2273360, 69)
train_idx : 2272922
train_idx : <class 'numpy.ndarray'>
val_idx : 438
val_idx : <class 'numpy.ndarray'>
val_idx : [1909126 1909627 1910115 1910814 1911007 1911131 1911294 1911941 1912297
 1912499 1912767 1913149 1913451 1913570 1914048 1914543 1914892 1915102
 1915475 1915744 1916078 1916594 1917210 1917696 1917829 1918148 1918403
 1918758 1919253 1919361 1920104 1920223 1920331 1920922 1921256 1921579
 1921786 1921935 1922380 1922918 1923220 1923360 1924010 1924546 1925151
 1925386 1925463 1926217 1926945 1927108 1927396 1927822 1928250 1928541
 1929144 1929465 1929843 1930456 1930629 1930976 1931193 1931406 1931838
 1932259 1932571 1933127 1933279 1933630 1933939 1934272 1934584 1934943
 1935549 1935792 1936305 1936435 1936741 1937066 1937378 1937587 1938016
 1938238 1938619 1939001 1939421 1939994 1940477 1940831 1941592 1941942
 1942676 1943153 1943573 1944006 1944433 1944767 1945270 1945483 1946007
 1946232 1946569 1947045 1947211 1947719 1948027 1948409 1948535 1949140
 1949376 1949532 1949733 1949855 1950507 1950745 1950979 1951141 1951876
 1951933 1952396 1952615 1953146 1953310 1953534 1954190 1954543 1954697
 1955084 1955478 1955876 1956279 1956682 1956788 1957088 1957572 1957755
 1958258 1958436 1958677 1958845 1959381 1959573 1960260 1960537 1960821
 1961026 1961107 1961430 1961781 1962220 1962405 1962707 1963112 1963390
 1963680 1963866 1963997 1964248 1964826 1965198 1965414 1965757 1966207
 1966413 1966834 1967198 1967373 1967525 1967968 1968087 1968422 1968605
 1968828 1969345 1969712 1970277 1970505 1970934 1971184 1971445 1971792
 1972094 1972397 1972870 1972978 1973408 1973530 1973880 1973993 1974144
 1974484 1974777 1975128 1975633 1975885 1976434 1976606 1977014 1977264
 1977715 1978022 1978398 1978686 1978978 1979511 1979689 1979997 1980275
 1980843 1981292 1981451 1981906 1982223 1982633 1982860 1983030 1983127
 1983769 1984220 1984666 1985330 1985716 1986174 1986385 1986728 1987078
 1987419 1987744 1988656 1988874 1989139 1989412 1989665 1990078 1990477
 1990806 1991103 1991347 1991614 1992015 1992485 1992746 1993224 1993597
 1994041 1994239 1994740 1994936 1995238 1995478 1995874 1996404 1996687
 1996966 1997423 1997524 1997760 1997978 1998301 1998419 1998969 1999226
 1999531 1999653 2000140 2000420 2000669 2000773 2000908 2001150 2001435
 2001640 2001882 2002062 2002338 2002861 2003581 2003984 2004119 2004399
 2004800 2004973 2005255 2005486 2005796 2006048 2006650 2006875 2007335
 2007752 2007931 2008241 2008473 2008798 2009094 2009293 2009764 2010044
 2010534 2010798 2010883 2011189 2011572 2011709 2011907 2012237 2012490
 2012621 2012727 2013095 2013507 2013735 2014037 2014419 2014892 2015007
 2015241 2015502 2015947 2016237 2016796 2017117 2017393 2017631 2018281
 2018699 2019189 2019551 2020251 2020361 2020659 2020878 2021065 2021393
 2021538 2021698 2021871 2022080 2022179 2022489 2022975 2023263 2023674
 2024012 2024169 2024684 2025000 2025128 2025329 2025612 2026155 2026435
 2026784 2026975 2027337 2027607 2028207 2028534 2028815 2029163 2029672
 2030311 2030646 2030932 2031121 2031374 2031515 2031965 2032186 2032486
 2032706 2033265 2033465 2033692 2034121 2034625 2034832 2035287 2035471
 2035866 2036170 2036603 2036934 2037341 2037982 2038348 2038806 2039057
 2039894 2040126 2040336 2040587 2040784 2041134 2041430 2041660 2041999
 2042385 2042689 2042818 2043057 2043154 2043405 2043692 2043884 2044086
 2044531 2044813 2045141 2045388 2045739 2046103 2046331 2046531 2046829
 2047469 2048025 2048198 2048861 2049371 2049432 2049843 2050132 2050292
 2050739 2051310 2051686 2051886 2052361 2052851 2053025 2053294 2053484
 2053626 2054087 2054492 2054813 2055353 2055788]
shape of X : (2273360, 69)

10it [00:57,  5.74s/it]train_idx : 2272922
train_idx : <class 'numpy.ndarray'>
val_idx : 438
val_idx : <class 'numpy.ndarray'>
val_idx : [2055979 2056227 2056825 2057169 2057938 2058404 2058651 2059252 2059539
 2059678 2059913 2060014 2060263 2060655 2060829 2061544 2061792 2062092
 2062590 2062808 2063020 2063201 2063779 2064044 2064278 2064775 2064978
 2065212 2065550 2066074 2066403 2066791 2067052 2067457 2067546 2067832
 2068133 2068334 2068517 2068987 2069142 2069708 2069990 2070353 2070621
 2070654 2070856 2070975 2071303 2071584 2072052 2072403 2072658 2072958
 2072996 2073301 2073505 2073633 2073870 2074275 2074621 2074750 2074914
 2075056 2075425 2075843 2076059 2076393 2076430 2076651 2076821 2077151
 2077573 2077748 2077995 2078140 2078319 2078578 2078922 2079516 2079950
 2080287 2080450 2080719 2081588 2081692 2081903 2082117 2082530 2082690
 2083000 2083164 2083387 2083511 2083855 2084017 2084316 2084480 2084670
 2085064 2085212 2085465 2085658 2085740 2085905 2086048 2086379 2086585
 2086723 2087018 2087148 2087322 2087739 2087880 2088182 2088279 2088340
 2088660 2089133 2089265 2089402 2089701 2089964 2090272 2090635 2090892
 2091029 2091220 2091855 2092204 2092389 2092792 2093276 2094039 2094327
 2094551 2094838 2095096 2095573 2095726 2096162 2096395 2097158 2097563
 2098017 2098485 2098725 2098982 2099421 2099835 2100212 2100434 2100651
 2101265 2101583 2101981 2102259 2102551 2102845 2103219 2103395 2103877
 2104017 2104334 2104792 2104919 2105308 2105657 2105777 2105976 2106190
 2106380 2106784 2106982 2107148 2107414 2107929 2108119 2108347 2108553
 2108884 2109147 2109382 2109461 2109789 2110156 2110337 2110608 2110878
 2111174 2111306 2111731 2112097 2112153 2112331 2112575 2113023 2113139
 2113590 2114101 2114327 2114525 2114663 2114822 2115347 2115680 2115956
 2116305 2116503 2117066 2117694 2117762 2118001 2118249 2118509 2118931
 2119443 2119947 2120246 2120308 2120581 2121048 2121170 2121667 2121989
 2122302 2122814 2123081 2123369 2123637 2124137 2124651 2125051 2125182
 2125353 2125649 2125939 2126122 2126427 2126544 2126716 2127151 2127213
 2127655 2127998 2128185 2128643 2128764 2129206 2129507 2129757 2130018
 2130233 2130579 2130847 2131146 2131422 2131672 2131799 2131959 2132345
 2132489 2132748 2133119 2133549 2133733 2133941 2134236 2134911 2135590
 2135749 2135992 2136085 2136314 2136421 2136562 2136933 2137137 2137306
 2137395 2137720 2137847 2138315 2138769 2139140 2139372 2139640 2139888
 2140096 2140569 2140732 2140850 2141103 2141325 2141626 2141944 2142306
 2142546 2142790 2143104 2143265 2143396 2143673 2144197 2144720 2145069
 2145151 2145461 2145602 2145928 2146193 2146298 2146612 2146993 2147131
 2147337 2147655 2147840 2147973 2148093 2148341 2148528 2148694 2149056
 2149479 2149577 2149745 2149981 2150541 2150798 2151036 2151205 2151387
 2151636 2152066 2152330 2152580 2152810 2152908 2153031 2153494 2153621
 2153786 2153974 2154287 2154462 2154651 2154720 2155297 2155531 2155697
 2155891 2156074 2156501 2156751 2156917 2157134 2157514 2157780 2158030
 2158250 2158390 2158689 2158779 2158886 2159295 2159415 2159724 2160013
 2160285 2160453 2160709 2160953 2161262 2161450 2161554 2161735 2162102
 2162523 2162660 2163027 2163244 2163441 2163665 2164010 2164344 2164569
 2164640 2164940 2165265 2165534 2165805 2166263 2166460 2166640 2166805
 2167237 2167290 2167574 2168061 2168392 2168683 2168913 2169159 2169604
 2169742 2170115 2170164 2170321 2170552 2170682 2171032 2171125 2171609
 2171865 2172148 2172545 2172731 2173267 2173596 2173925 2174213 2174326
 2174645 2174841 2174951 2175245 2175498 2175649 2175801 2175967 2176218
 2176380 2176490 2176716 2177001 2177295 2177429]
shape of X : (2273360, 69)
train_idx : 2272922
train_idx : <class 'numpy.ndarray'>
val_idx : 438
val_idx : <class 'numpy.ndarray'>
val_idx : [2177612 2178046 2178234 2178727 2178982 2179148 2179286 2179503 2179780
 2180096 2180342 2180565 2180686 2180882 2181109 2181252 2181663 2182065
 2182371 2182482 2182565 2182764 2183071 2183174 2183429 2183665 2183914
 2184043 2184318 2184657 2184756 2184902 2185236 2185755 2186075 2186272
 2186353 2186640 2186895 2187117 2187374 2187921 2188002 2188240 2188306
 2188466 2188581 2188761 2189218 2189536 2189888 2190262 2190707 2190908
 2191051 2191467 2191727 2191933 2192367 2192604 2192845 2193065 2193247
 2193403 2193529 2193707 2193906 2194164 2194500 2194830 2195064 2195272
 2195457 2195671 2195746 2195835 2196097 2196296 2196480 2196632 2196726
 2196786 2197039 2197212 2197514 2197847 2197984 2198120 2198245 2198471
 2198904 2199041 2199183 2199542 2200113 2200294 2200542 2200645 2200925
 2201154 2202040 2202195 2202439 2202776 2203140 2203412 2203842 2203947
 2204206 2204437 2204712 2204984 2205068 2205243 2205374 2205632 2205733
 2205867 2206063 2206168 2206419 2206582 2206840 2207065 2207323 2207393
 2207612 2207732 2207831 2207894 2208101 2208562 2208979 2209106 2209356
 2209432 2209740 2209915 2210059 2210349 2210854 2210981 2211215 2211376
 2211661 2211727 2211851 2212415 2212650 2212877 2213070 2213273 2213480
 2213624 2213992 2214178 2214340 2214476 2214602 2214859 2214941 2215193
 2215279 2215520 2215886 2216019 2216345 2216559 2216843 2217217 2217443
 2217709 2218011 2218152 2218343 2218625 2218861 2218932 2219175 2219230
 2219500 2219757 2220038 2220203 2220366 2220620 2220731 2220926 2221109
 2221266 2221562 2221785 2222103 2222442 2222466 2222568 2222734 2223073
 2223345 2223718 2223961 2224344 2224795 2225036 2225209 2225341 2225519
 2225691 2225778 2226003 2226442 2226753 2226836 2226951 2227053 2227281
 2227519 2227814 2227886 2228045 2228379 2228724 2228967 2229105 2229333
 2229730 2229976 2230228 2230323 2230504 2230855 2231160 2231365 2231522
 2231847 2232213 2232568 2232706 2233083 2233236 2233470 2233716 2233771
 2233859 2234063 2234322 2234395 2234630 2234840 2234907 2235054 2235147
 2235414 2235566 2235686 2235886 2236193 2236401 2236580 2236794 2237007
 2237373 2237847 2238265 2238301 2238466 2238652 2238938 2239097 2239421
 2239812 2239927 2240184 2240324 2240685 2240793 2241307 2241422 2241806
 2241947 2242267 2242565 2242727 2242829 2242963 2243301 2243382 2243679
 2243948 2244178 2244410 2244640 2245013 2245396 2245625 2245749 2245876
 2245995 2246069 2246439 2246600 2246662 2246798 2247091 2247211 2247522
 2247763 2247895 2248203 2248242 2248667 2248846 2248981 2249086 2249367
 2249764 2249968 2250242 2250391 2250763 2251087 2251271 2251690 2251890
 2252355 2252510 2252877 2253056 2253266 2253355 2253489 2253740 2253930
 2254221 2254435 2254842 2254992 2255295 2255397 2255556 2255689 2255796
 2256061 2256306 2256428 2256554 2256623 2256803 2256935 2257126 2257270
 2257352 2257549 2257863 2258063 2258287 2258543 2258723 2258973 2259064
 2259274 2259586 2259669 2260221 2260490 2260698 2260842 2261061 2261171
 2261443 2261575 2261688 2262024 2262254 2262605 2262903 2263103 2263264
 2263555 2263679 2263801 2264021 2264241 2264369 2264561 2264808 2264933
 2265051 2265195 2265496 2265621 2265838 2265928 2266037 2266199 2266379
 2266709 2266764 2266912 2267112 2267219 2267273 2267357 2267770 2267874
 2268050 2268189 2268250 2268509 2268721 2269012 2269221 2269333 2269446
 2269589 2269707 2269823 2269952 2270125 2270216 2270293 2270454 2270720
 2271000 2271126 2271301 2271474 2271754 2271825 2272121 2272272 2272313
 2272495 2272785 2272980 2273181 2273291 2273359]
shape of X : (2273360, 69)
valid Set이 된 모든 row들의 개수 : 4383
valid Set이 된 모든 row들 unique 개수 : 4383
```



### 결론

1. 대량의 시간소요 이슈
   - list comprehension 등 상대적으로 효율성이 고려되지 않은 코드들이 존재하였기 때문.
   - numpy의 집합연산 메소드 등 numpy 내부 함수들을 이용하여 효율성을 높일 수 있었음.
   - 결과적으로 1 fold당 5분이 소요되었던 부분이 약 6초로 줄었음.
2. IndexError가 발생했던 이유
   - pycaret의 setup에서 train_size로 subsampling된 data를 학습에 이용하는 것에 반하여
   - 이전에 구현했던 코드들은 함수 외부에서 전체 학습데이터에서 last user id를 미리 추출하고 선언해주다 보니, index 초과 에러가 발생한 것이었음.
   - FEATS에 userID를 추가해준 뒤, CustomizedKFold 내부에서 last user id를 추출할 수 있게 코드를 수정하였음.
3. userID가 shuffle되어버리는 이슈
   - pycaret의 setup에서 data_split_shuffle = False을 설정함으로써 해결하였음.
4. Validset의 개수가 일정하지 않고 차이가 많이 나는 이슈
   - KFold의 input으로 last user id 자체를 넣어줌으로써 균등하게 split할 수 있도록 하여 해결하였다.
