

#### 1. 우리 주변의 추천 시스템

1.1 아마존에서의 상품 추천

- Amazon.com 메인 페이지에는 고객 맞춤형 상품 목록을 보여줍니다
- Amazon.com에서 특정 상품을 살펴볼 때, 함께 혹은 대신 구매할 상품 목록을 보여줍니다

1.2 넷플릭스에서의 영화 추천

- 넷플릭스 메인 페이지에는 고객 맞춤형 영화 목록을 보여줍니다

1.3 유튜브에서의 영상 추천

- 유튜브 메인 페이지에는 고객 맞춤형 영상 목록을 보여줍니다
- 유튜브는 현재 재생 중인 영상과 관련된 영상 목록을 보여줍니다

1.4 페이스북에서의 친구 추천

- 페이스북에서는 추천하는 친구의 목록을 보여줍니다

1.5 추천 시스템과 그래프

- 추천 시스템은 사용자 각각이 구매할 만한 혹은 선호할 만한 상품을 추천합니다
- 사용자별 구매 기록은 아래 예시처럼 그래프로 표현 가능합니다 구매 기록이라는 암시적(Implicit)인 선호만 있는 경우도 있고, 평점이라는 명시적(Explicit)인 선호가 있는 경우도 있습니다
- 추천 시스템은 사용자 각각이 구매할 만한 혹은 선호할 만한 상품/영화/영상을 추천합니다
- 추천 시스템의 핵심은 사용자별 구매를 예측하거나 선호를 추정하는 것입니다
- 그래프 관점에서 추천 시스템은 “미래의 간선을 예측하는 문제” 혹은 “누락된 간선의 가중치를 추정하는 문제”로 해석할 수 있습니다

#### 2. 내용 기반 추천시스템

2.1 내용 기반 추천시스템의 원리

- 내용 기반(Content-based) 추천은 각 사용자가 구매/만족했던 상품과 유사한 것을 추천하는 방법입니다

- 예시는 다음과 같습니다

  - 동일한 장르의 영화를 추천하는 것
  - 동일한 감독의 영화 혹은 동일 배우가 출현한 영화를 추천하는 것
  - 동일한 카테고리의 상품을 추천하는 것
  - 동갑의 같은 학교를 졸업한 사람을 친구로 추천하는 것

- 내용 기반 추천은 다음 네 가지 단계로 이루어집니다

  

  - 첫 단계는 사용자가 선호했던 상품들의 상품 프로필(Item Profile)을 수집하는 단계입니다
    - 어떤 상품의 상품 프로필이란 해당 상품의 특성을 나열한 벡터입니다
    - 영화의 경우 감독, 장르, 배우 등의 원-핫 인코딩이 상품 프로필이 될 수 있습니다
  - 다음 단계는 사용자 프로필(User Profile)을 구성하는 단계입니다
    - 사용자 프로필은 선호한 상품의 상품 프로필을 선호도를 사용하여 가중 평균하여 계산합니다
    - 즉 사용자 프로필 역시 벡터입니다
  - 다음 단계는 사용자 프로필과 다른 상품들의 상품 프로필을 매칭하는 단계입니다
    - 사용자 프로필 벡터와 상품 프로필 벡터로 코사인 유사도를 계산합니다
    - 즉, 두 벡터의 사이각의 코사인 값을 계산합니다
    - 코사인 유사도가 높을 수록, 해당 사용자가 과거 선호했던 상품들과 해당 상품이 유사함을 의미합니다
  - 마지막 단계는 사용자에게 상품을 추천하는 단계입니다
    - 계산한 코사인 유사도가 높은 상품들을 추천합니다

2.2 내용 기반 추천시스템의 장단점

- 내용 기반 추천시스템은 다음 장점을 갖습니다
  (1) 다른 사용자의 구매 기록이 필요하지 않습니다
  (2) 독특한 취향의 사용자에게도 추천이 가능합니다
  (3) 새 상품에 대해서도 추천이 가능합니다
  (4) 추천의 이유를 제공할 수 있습니다
- 내용 기반 추천시스템은 다음 단점을 갖습니다
  (1) 상품에 대한 부가 정보가 없는 경우에는 사용할 수 없습니다
  (2) 구매 기록이 없는 사용자에게는 사용할 수 없습니다
  (3) 과적합(Overfitting)으로 지나치게 협소한 추천을 할 위험이 있습니다

#### 3. 협업 필터링 추천시스템

3.1 협업 필터링의 원리

- 사용자-사용자 협업 필터링은 다음 세 단계로 이루어집니다
  - 추천의 대상 사용자를 𝑥라고 합시다
  - 우선 𝑥와 유사한 취향의 사용자들을 찾습니다
  - 다음 단계로 유사한 취향의 사용자들이 선호한 상품을 찾습니다
  - 마지막으로 이 상품들을 𝑥에게 추천합니다
- 사용자-사용자 협업 필터링의 핵심은 유사한 취향의 사용자를 찾는 것입니다
- 그런데 취향의 유사도는 어떻게 계산할까요?
- 취향의 유사성은 상관 계수(Correlation Coefficient)를 통해 측정합니다
- 사용자 𝑥의 상품 𝑠에 대한 평점을 𝑟𝑥𝑠라고 합시다
- 사용자 𝑥가 매긴 평균 평점을 𝑟𝑥라고 합시다
- 사용자 𝑥와 𝑦가 공동 구매한 상품들을 𝑆𝑥𝑦라고 합시다
- 사용자 𝑥와 𝑦의 취향의 유사도는 아래 수식으로 계산합니다
  ![img](https://media.vlpt.us/images/skaurl/post/2779d266-1e25-4078-8cc1-49395c3f2570/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7%202021-02-24%2010.25.11.png)
- 즉, 통계에서의 상관 계수(Correlation Coefficient)를 사용해 취향의 유사도를 계산합니다
- 구체적으로 취향의 유사도를 가중치로 사용한 평점의 가중 평균을 통해 평점을 추정합니다
- 사용자 𝑥의 상품 𝑠에 대한 평점을 𝑟𝑥𝑠를 추정하는 경우를 생각합시다
- 앞서 설명한 상관 계수를 이용하여 상품 𝑠를 구매한 사용자 중에 𝑥와 취향이 가장 유사한 𝑘명의 사용자 𝑁(𝑥; 𝑠)를 뽑습니다
- 평점 𝑟𝑥𝑠는 아래의 수식을 이용해 추정합니다
  ![img](https://media.vlpt.us/images/skaurl/post/68f10294-5575-4dae-9f86-732bf3b7c9de/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7%202021-02-24%2010.27.17.png)
- 즉, 취향의 유사도를 가중치로 사용한 평점의 가중 평균을 계산합니다
- 마지막 단계는 추정한 평점이 가장 높은 상품을 추천하는 단계입니다
- 추천의 대상 사용자를 𝑥라고 합시다
- 앞서 설명한 방법을 통해, 𝑥가 아직 구매하지 않은 상품 각각에 대해 평점을 추정합니다
- 추정한 평점이 가장 높은 상품들을 𝑥에게 추천합니다

3.2 협업 필터링의 장단점

- 협업 필터링은 다음 장점과 단점 갖습니다
  (+) 상품에 대한 부가 정보가 없는 경우에도 사용할 수 있습니다
  (−) 충분한 수의 평점 데이터가 누적되어야 효과적입니다
  (−) 새 상품, 새로운 사용자에 대한 추천이 불가능합니다
  (−) 독특한 취향의 사용자에게 추천이 어렵습니다

#### 4. 추천 시스템의 평가

4.1 데이터 분리

- 추천 시스템의 정확도는 어떻게 평가할까요?
  - 먼저 데이터를 훈련(Training) 데이터와 평가(Test) 데이터로 분리합니다
  - 평가 데이터는 주어지지 않았다고 가정합시다
  - 훈련 데이터를 이용해서 가리워진 평가 데이터의 평점을 추정합니다
  - 추정한 평점과 실제 평가 데이터를 비교하여 오차를 측정합니다

4.2 평가 지표

- 추정한 평점과 실제 평가 데이터를 비교하여 오차를 측정합니다

- 오차를 측정하는 지표로는 평균 제곱 오차(Mean Squared Error, MSE)가 많이 사용됩니다

- 평가 데이터 내의 평점들을 집합을 𝑇라고 합시다

- 평균 제곱 오차는 아래 수식으로 계산합니다

  <img src="https://media.vlpt.us/images/skaurl/post/9ddea3c6-96fc-4cd9-851c-23aad3521dec/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7%202021-02-24%2010.30.17.png" alt="img" style="zoom:50%;" />

- 평균 제곱근 오차(Root Mean Squared Error, RMSE)도 많이 사용됩니다

  <img src="https://media.vlpt.us/images/skaurl/post/1762e510-4339-4ac7-853e-237dc2576967/%EC%8A%A4%ED%81%AC%EB%A6%B0%EC%83%B7%202021-02-24%2010.30.34.png" alt="img" style="zoom:50%;" />

- 이 밖에도 다양한 지표가 사용됩니다

  1) RMSE

  2) 추정한 평점으로 순위를 매긴 후, 실제 평점으로 매긴 순위와의 상관 계수 (스피어만 상관계수?)

  3) 추천한 상품 중 실제 구매로 이루어진 것의 비율

  4) 추천의 순서 혹은 다양성까지 고려하는 지표

  

- 추정한 평점으로 순위를 매긴 후, 실제 평점으로 매긴 순위와의 상관 계수를 계산하기도 합니다

- 추천한 상품 중 실제 구매로 이루어진 것의 비율을 측정하기도 합니다

- 추천의 순서 혹은 다양성까지 고려하는 지표들도 사용됩니다

#### 6강 정리

1. 우리 주변의 추천 시스템

- Amazon.com, 넷플릭스, 페이스북, 유튜브 등

1. 내용 기반 추천 시스템

- 장점: 새로운 상품에 대한 추천이 가능
- 단점:상품에대한부가정보가있는경우에만사용가능

1. 협업 필터링

- 장점:부가정보가없는경우에도사용가능 – 단점: 새로운 상품에 대한 추천이 불가능

1. 추천 시스템의 평가

- 학습/평가 데이터 분리, 평균 제곱(근) 오차

